      subroutine geostd(m,pin,phiin)        
c         
c ** neprf **, programmer - tom rosmond, 4 august 1987      
c         
c  table lookup for standard atmosphere geopotentials as a function   
c  of pressure.  table has resolution of 10mbs below 100mb, 1mb       
c  from 100mbs to 1 mb.  interpolation is linear in log p.  
c         
c         
c  *********************************************************************        
c         
c         
      dimension pin(m),phiin(m)     
      dimension phi(230)
c
c     dimension phi(230),phi1(55),phi2(60),phi3(55),phi4(60)
c     equivalence (phi(116),phi3)       
c     equivalence (phi(171),phi4)       
c         
c     equivalence (phi,phi1)  
c     equivalence (phi(56),phi2)        
c         
c     data  phi1/
      data (phi(i),i=1,55) /
     x  31055. ,26481. ,23849. ,22000. ,20576.
     x ,19420. ,18442. ,17595. ,16848. ,16180.
     x ,15576. ,15024. ,14516. ,14046. ,13608.
     x ,13199. ,12815. ,12452. ,12110. ,11784.
     x ,11475. ,11180. ,10898. ,10626. ,10363.
     x ,10109. , 9862. , 9623. , 9390. , 9164.
     x , 8944. , 8730. , 8521. , 8317. , 8117.
     x , 7923. , 7733. , 7546. , 7364. , 7185.
     x , 7011. , 6839. , 6671. , 6506. , 6344.
     x , 6185. , 6028. , 5874. , 5723. , 5574.
     x , 5428. , 5284. , 5143. , 5003. , 4865./
c     data  phi2/
      data (phi(i),i=56,115) /
     x   4730. , 4596. , 4465. , 4335. , 4206.
     x , 4080. , 3955. , 3832. , 3711. , 3591.
     x , 3472. , 3355. , 3240. , 3125. , 3012.
     x , 2901. , 2790. , 2681. , 2573. , 2466.
     x , 2361. , 2256. , 2153. , 2050. , 1949.
     x , 1849. , 1750. , 1651. , 1554. , 1457.
     x , 1362. , 1267. , 1174. , 1081. ,  988.
     x ,  897. ,  807. ,  717. ,  629. ,  540.
     x ,  453. ,  367. ,  281. ,  195. ,  111.
     x ,   27. ,  -55. , -137. , -219. , -301.
     x , -381. , -461. , -540. , -619. , -698.
     x , -775. , -852. , -928. ,-1004. ,-1080./
c     data  phi3/
      data (phi(i),i=116,170) /
     x  47832. ,42451. ,39436. ,37360. ,35786.
     x ,34520. ,33462. ,32554. ,31760. ,31055.
     x ,30421. ,29843. ,29313. ,28824. ,28369.
     x ,27944. ,27546. ,27171. ,26817. ,26481.
     x ,26163. ,25860. ,25571. ,25294. ,25028.
     x ,24775. ,24530. ,24295. ,24068. ,23849.
     x ,23637. ,23433. ,23235. ,23043. ,22856.
     x ,22675. ,22500. ,22329. ,22162. ,22000.
     x ,21842. ,21688. ,21538. ,21391. ,21247.
     x ,21107. ,20970. ,20836. ,20705. ,20576.
     x ,20451. ,20327. ,20206. ,20088. ,19971./
c     data  phi4/
      data (phi(i),i=171,230) /
     x  19857. ,19745. ,19634. ,19526. ,19420.
     x ,19315. ,19211. ,19110. ,19010. ,18912.
     x ,18815. ,18720. ,18626. ,18533. ,18442.
     x ,18352. ,18263. ,18176. ,18090. ,18004.
     x ,17920. ,17837. ,17756. ,17675. ,17595.
     x ,17516. ,17439. ,17362. ,17286. ,17211.
     x ,17136. ,17063. ,16991. ,16919. ,16848.
     x ,16778. ,16709. ,16640. ,16572. ,16505.
     x ,16439. ,16373. ,16308. ,16244. ,16180.
     x ,16117. ,16054. ,15993. ,15931. ,15871.
     x ,15810. ,15751. ,15692. ,15634. ,15576.
     x ,15518. ,15461. ,15405. ,15349. ,15294./
c         
cmic$ do all vector if (m.gt.10000)
cmic$1 shared (m,pin,phi,phiin)
cmic$1 private (i,phix,ii,pw2)
c
      do 3 i=1,m    
      phix= pin(i)*0.1              
      if(pin(i).lt.100.0) phix= max(1.000001,pin(i))    
c         
      ii= int(phix)    
      pw2= phix/float(ii)
      phix= 1.0+1.0/float(ii)
      if(pin(i).lt.100.0) ii= ii+115        
c         
      phiin(i)= phi(ii)+(phi(1+ii)-phi(ii))*log(pw2)/log(phix)
    3 continue
      return        
      end 
