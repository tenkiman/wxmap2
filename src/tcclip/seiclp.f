C***********************************************************************
      SUBROUTINE SEICLP(IDATIM,ALAT00,ALON00,ALAT12,ALON12,ALAT24,
     $ALON24,WIND,DISP,CFCST,P1TOP8)
C
C THIS IS A CLIPER PROGRAM FOR THE AUSTRALIA/SE INDIAN OCEAN BASIN (AREA 
C     OF SOUTHERN HEMISPHERE BETWEEN 142E AND 100E.)
C     FOLLOWING SHOULD BE NOTED:
C (1) PROGRAM WAS DEVELOPED USING SOUTHERN HEMISPHERE STORM TRACKS OVER 
C     YEARS 1970/1971 TO 1999/2000.
C (2) ALL MONTHS EXCEPT 1 JULY THROUGH 15 SEPTEMBER WERE INCLUDED IN 
C     DEVELOPMENTAL DATA SET.  THESE DATES ARE CONVERTED TO 30 JUNE
C     OR 16 SEPTEMBER, WHICHEVER IS CLOSER IN TIME.
C     
C (3) PORTIONS OF STORMS HAVING VERIFYING POSITIONS EAST OF 142 DEGREES
C     OR WEST OF 100 DEGREES WERE EXCLUDED FROM DEVELOPMENTAL DATA SET.
C     NUMBER OF TC'S INCLUDED = 279
C (4) STORMS POSITIONS SOUTH OF 50S WERE EXCLUDED FROM DEVELOPMENTAL
C     DATA SET.
C (5) STORMS WHICH INITIALLY CLASSIFIED AS DEPRESSIONS OR CLASSIFIED AS
C     DEPRESSIONS AT VERIFICATION TIME WERE EXCLUDED.
C (6) SAMPLE SIZE,  2582 AT 12H,  2229 AT 24H,  1918 AT 36H,
C                   1644 AT 48H,  1381 AT 60H,  1157 AT 72H.
C (7) INDIVIDUAL CASES IN DEVELOPMENTAL DATA SET WERE AT 6 HRLY INTERVALS
C (8) PROGRAM PREPARED BY CHARLES J. NEUMANN, SAIC, OCTOBER, 2000.
C
C INCOMING ARGUMENTS ARE AS FOLLOWS:
C   IDATIM (INTEGER*4) IS IN FORM YY/MO/DA/HR AS 01040106 FOR
C   DATE APRIL 1, 2001, 0600UTC.
C   ALAT00 AND ALON00 ARE INITIAL STORM POSITION (REAL*4)
C   ALAT12 AND ALON12 ARE POSITION 12H EARLIER   (REAL*4)
C   ALAT24 AND ALON24 ARE POSITION 24H EARLIER   (REAL*4)
C     NOTE: IT IS ASSUMED THAT LATITUDES AND LONGITUDES WILL BE ENTERED
C           AS POSITIVE VALUES.
C
C   WIND IS MAXIMUM WIND (1-MINUTE AVERAGE) NEAR STORM CENTER IN KNOTS
C   (REAL*4).
C
C RETURNED ARGUMENTS ARE:
C   STORM DISPLACEMENTS AS GIVEN BY (DISP(J),J=1,12);
C   POSITIONS AS GIVEN BY (CDISP(J),J=1,12);
C   VALUES OF 8 BASIC PREDICTORS AS GIVEN BY (P1TOP8(K),K=1,8)
C
C ARRANGEMENT OF DISP AND CDISP ARRAY IS AS FOLLOWS:
C      DISP(01) IS MERIDIONAL 12H DISPLACEMENT (NMI)
C      DISP(02) IS ZONAL 12H DISPLACEMENT (NMI)
C      DISP(03) IS MERIDIONAL 24H DISPLACEMENT (NMI)
C      DISP(04) IS ZONAL 24H DISPLACEMENT (NMI)
C      DISP(05) IS MERIDIONAL 36H DISPLACEMENT (NMI)
C      DISP(06) IS ZONAL 36H DISPLACEMENT (NMI)
C      DISP(07) IS MERIDIONAL 48H DISPLACEMENT (NMI)
C      DISP(08) IS ZONAL 48H DISPLACEMENT (NMI)
C      DISP(09) IS MERIDIONAL 60H DISPLACEMENT (NMI)
C      DISP(10) IS ZONAL 60H DISPLACEMENT (NMI)
C      DISP(11) IS MERIDIONAL 72H DISPLACEMENT (NMI)
C      DISP(12) IS ZONAL 72H DISPLACEMENT (NMI)
C NOTE: SEE NOTE 1 AND NOTE 2 FOR SIGN CONVENTION OF ABOVE DISP ARRAY.
C       CDISP ARRAY CORRESPONDS TO DISP ARRAY EXCEPT THAT DISPLACEMENTS
C       HAVE BEEN CONVERTED TO LATITUDES SOUTH AND LONGITUDES EAST
C
      COMMON/BLOCKSE1/RCM(16,6),RCZ(14,6),CNSTM(6),CNSTZ(6)
      INTEGER*2 NPM(16,6),NPZ(14,6)
      COMMON/BLOCKSE2/NPM,NPZ
      REAL*4 P(166),DISP(12),CFCST(12),P1TOP8(8)
C INITIALLY, 5 PREDICTORS OUT OF 164 POSSIBLE PREDICTORS (LISTED IN
C SUBROUTINE SETUP) WERE SELECTED FOR EACH TIME PERIOD AND FOR BOTH ZONAL
C AND MERIDIONAL MOTION.  A FINAL SET OF PREDICTORS FOR EACH COMPONENT OF
C MOTION INCLUDED ALL PREDICTORS SELECTED AT LEAST ONCE, 12 THRU 72H.
C THIS TURNED OUT TO BE 16 PREDICTORS FOR MERIDIONAL MOTION AND 14 FOR
C ZONAL MOTION.
C
C ALL REGRESSION COEFFICIENTS AND PREDICTOR NUMBERS ARE 
C ENTERED IN BLOCK DATA BLKSE1.  THERE ARE 16 PREDICTORS AND PREDICTOR
C NUMBERS FOR MERIDIONAL MOTION AND 14 PREDICTORS AND PREDICTOR NUMBERS
C FOR ZONAL MOTION. ((RCM(I,J),J=1,6,I=1,16) & ((NPM(I,J),J=1,6),I=1,16)
C ARE COEFFICEINTS AND PREDICTOR NUMBERS FOR MERIDIONAL MOTION WHILE
C ((RCZ(I,J),J=1,6,I=1,14) AND ((NPZ(I,J),J=1,6),I=1,14) ARE COEFFICIENTS
C AND PREDICTOR NUMBERS FOR ZONAL MOTION. SUBSCRIPT J REFERS TO TIME WHERE
C J=1=12H.........J=6=72H.
C 6 MERIDIONAL INTERCEPT VALUES ARE GIVEN BY (CNSTM(J),J=1,6) WHILE THE
C 6 ZONAL INTERCEPT VALUES ARE GIVEN BY (CNSTZ(J),J=1,6).
C P1 THRU P8 ARE 8 PRIMARY PREDICTORS WHERE...
C      P1 IS INITIAL LATITUDE  (DEGS SOUTH)
C      P2 IS INITIAL LONGITUDE (DEGS EAST)
C      P3 IS JULIAN DAY NUMBER FUNCTION DEFINED AS NUMBER OF DAYS (ABSOLUTE)
C      EITHER SIDE OF FEBRUARY 25 (APPROXIMATE MID-SEASON FOR THIS AREA).
C      P4 IS MERIDIONAL DISPLACEMENT 00 TO -12H (NMI)
C      P5 IS ZONAL DISPLACEMENT 00 TO -12H (NMI)
C      P6 IS MERIDIONAL DISPLACEMENT 00 TO -24H (NMI)
C      P7 IS ZONAL DISPLACEMENT 00 TO -24H (NMI)
C      P8 IS MAXIMUM WIND (KNOTS) ASSUMING A 1-MINUTE WIND MEASURING
C         SYSTEM.
C FUNCTIONS AND SUBPROGRAMS NEEDED BY SEICLP ARE AS FOLLOWS:
C    DATA NEEDED BY PROGRAM ARE CONTAINED IN BLOCK DATA BLKSE1 AND BLKSE2
C    SEICLP CALLS SUBROUTINES STHGPR, LL2XYH, SETUP AND YX2LL
C           AND UTILIZES FUNCTIONS F1, F2
C    YX2LL CALLS SUBROUTINE XY2LLH AND UTILIZES FUNCTION F1
C SET UP 8 BASIC PREDICTORS......
      P1=ALAT00
      P2=ALON00
C JULIAN DAY NUMBER
      DANBR=F2(IDATIM)
      IDN=DANBR+.5
C AVERAGE TC DAY NUMBER FOR THIS BASIN IS NEAR 56 (25 MARCH)
      MEANDN=56
C
C CHANGE DAY NUMBERS FOR OFF-SEASON STORMS
      IF(IDN.GT.181.AND.IDN.LE.220)IDN=181
      IF(IDN.GT.220.AND.IDN.LT.259)IDN=259
C
      IF(IDN.GE.1.AND.IDN.LE.181)IDADIF=IABS(MEANDN-IDN)
      IF(IDN.GE.259)IDADIF=366-IDN+MEANDN
      P3=IDADIF
      P8=WIND
C USE AL TAYLOR ROUTINE FOR CONVERTING LATITUDE/LONGITUDE TO DISPLACEMENTS.
C THIS SAME ROUTINE IS LATER USED FOR CONVERTING DISPLACEMENTS BACK TO
C LATITUDES AND LONGITUDES........
C (PREDICTORS NUMBER P4 THRU P7)
      CALL STHGPR(P1,F1(P2),360.,1.,0.,0.)
      CALL LL2XYH(ALAT12,F1(ALON12),P5,P4)
      CALL LL2XYH(ALAT24,F1(ALON24),P7,P6)
C CHANGE SIGN
      P4=-P4
      P5=-P5
      P6=-P6
      P7=-P7
C BASIC PREDICTOR SETUP IS COMPLETE. PUT 8 VALUES INTO ARRAY P1TOP8 FOR
C POSSIBLE USE IN CALLING PROGRAM
      P1TOP8(1)=P1
      P1TOP8(2)=P2
      P1TOP8(3)=P3
      P1TOP8(4)=P4
      P1TOP8(5)=P5
      P1TOP8(6)=P6
      P1TOP8(7)=P7
      P1TOP8(8)=P8
C
C PREPARE FORECAST, FIRST, OBTAIN ALL POSSIBLE 3RD ORDER PRODUCTS AND
C CROSS-PRODUCTS OF THE 8 BASIC PREDICTORS AND RETURN THESE IN ARRAY
C (P(L),L=1,166).  THERE ARE 164 POSSIBLE COMBINATIONS AND THESE ARE
C GIVEN BY SUBSCRIBTS 3 THROUGH 166. P(1) AND P(2) ARE NOT USED AND HAVE
C BEEN RETURNED AS DUMMY VARIABLES. NOT ALL OF THE 164 POSSIBLE PREDICTORS
C ARE USED IN PROGRAM.
      CALL SETUP(P1,P2,P3,P4,P5,P6,P7,P8,P)
C OBTAIN FORECAST MERIDIONAL DISPLACEMENTS 12 THRU 72H
      DO 60 J=1,6
C INITIALIZE COMPUTATION WITH INTERCEPT VALUE
      DISP(2*J-1)=CNSTM(J)
      DO 50 I=1,16
      K=NPM(I,J)
      DISP(2*J-1)=DISP(2*J-1)+RCM(I,J)*P(K)
   50 CONTINUE
   60 CONTINUE
C
C OBTAIN FORECAST ZONAL DISPLACEMENTS 12 THRU 72H
C
      DO 80 J=1,6
C INITIALIZE COMPUTATION WITH INTERCEPT VALUE
      DISP(2*J)=CNSTZ(J)
      DO 70 I=1,14
      K=NPZ(I,J)
      DISP(2*J)=DISP(2*J)+RCZ(I,J)*P(K)
   70 CONTINUE
   80 CONTINUE
C CONVERT DISPLACEMENTS TO LATITUDE AND LONGITUDE
      CALL YX2LL(ALAT00,ALON00,DISP,CFCST)
C NOTE 1
C IN ABOVE ARRAY ABOVE ZONAL DISPLACEMENTS ARE NEGATIVE TO THE WEST AND
C MERIDIONAL DISPLACEMENTS ARE NEGATINE TO THE NORTH.  REVERSE SIGN
C OF LATITUDINAL DISPLACEMENTS SUCH THAT TOWARDS SOUTH IS NEGATIVE.
      DO 90 J=1,11,2
   90 DISP(J)=-DISP(J)
C NOTE 2
C NOW, DISPLACEMENTS ARE CORRECT IN MATHEMATICAL SENSE.
      RETURN
      END
C***********************************************************************
cx    FUNCTION F1(ALON)
cxCONVERT FROM E LONGITUDE TO THOSE ACCEPTABLE IN AL TAYLOR ROUTINES
cx    IF(ALON.GT.180.)F1=360.-ALON
cx    IF(ALON.LE.180.)F1=-ALON
cx    RETURN
cx    END
cx**********************************************************************
cx    FUNCTION F2(IDATIM)
cxOBTAIN JULIAN DAY NUMBER
cx0000UTC ON 1 JAN IS SET TO DAY NUMBER 0. AND 1800UTC ON 31 DEC IS SET 
cxTO DAY NUMBER 364.75.  LEAP YEARS ARE IGNORED.
cx    CHARACTER*8 ALFA
cx    WRITE(ALFA,'(I8)')IDATIM
cx    READ(ALFA,'(4I2)')KYR,MO,KDA,KHR
cx    MON=MO
cx    IF(MON.EQ.13)MON=1
cx    DANBR=3055*(MON+2)/100-(MON+10)/13*2-91+KDA
cx    F2=DANBR-1.+FLOAT(KHR/6)*0.25
cx    RETURN
cx    END
C***********************************************************************
      BLOCK DATA BLKSE2
C
C   ALBION D. TAYLOR, MARCH 19, 1982
C  THE HURRICANE GRID IS BASED ON AN OBLIQUE EQUIDISTANT CYLINDRICAL
C  MAP PROJECTION ORIENTED ALONG THE TRACK OF THE HURRICANE.
C
C    THE X (OR I) COORDINATE XI OF A POINT REPRESENTS THE DISTANCE
C  FROM THAT POINT TO THE GREAT CIRCLE THROUGH THE HURRICANE, IN
C  THE DIRECTION OF MOTION OF THE HURRICANE MOTION.  POSITIVE VALUES
C  REPRESENT DISTANCES TO THE RIGHT OF THE HURRICANE MOTION, NEGATIVE
C  VALUES REPRESENT DISTANCES TO THE LEFT.
C    THE Y (OR J) COORDINATE OF THE POINT REPRESENTS THE DISTANCE
C  ALONG THE GREAT CIRCLE THROUGH THE HURRICANE TO THE PROJECTION
C  OF THE POINT ONTO THAT CIRCLE.  POSITIVE VALUES REPRESENT
C  DISTANCE IN THE DIRECTION OF HURRICANE MOTION, NEGATIVE VALUES
C  REPRESENT DISTANCE IN THE OPPOSITE DIRECTION.
C
C     SCALE DISTANCES ARE STRICTLY UNIFORM IN THE I-DIRECTION ALWAYS.
C  THE SAME SCALE HOLDS IN THE J-DIRECTION ONLY ALONG THE HURRICANE TRACK
C  ELSEWHERE, DISTANCES IN THE J-DIRECTION ARE EXAGERATED BY A FACTOR
C  INVERSELY PROPORTIONAL TO THE COSINE OF THE ANGULAR DISTANCE FROM
C  THE TRACK.  THE SCALE IS CORRECT TO 1 PERCENT WITHIN A DISTANCE OF
C  480 NM OF THE STORM TRACK, 5 PERCENT WITHIN 1090 NM, AND
C  10 PERCENT WITHIN 1550 NM.
C
C  BIAS VALUES ARE ADDED TO THE XI AND YJ COORDINATES FOR CONVENIENCE
C  IN INDEXING.
C
C  A PARTICULAR GRID IS SPECIFIED BY THE USER BY MEANS OF A CALL
C  TO SUBROUTINE STHGPR (SET HURRICANE GRID PARAMETERS)
C  WITH ARGUMENTS (XLATH,XLONH,BEAR,GRIDSZ,XIO,YJO)
C   WHERE
C     XLATH,XLONH = LATITUDE, LONGITUDE OF THE HURRICANE
C     BEAR        = BEARING OF THE HURRICANE MOTION
C     GRIDSZ      = SIZE OF GRID ELEMENTS IN NAUTICAL MILES
C     XIO, YJO    = OFFSETS IN I AND J COORDINATES (OR I AND J
C                     COORDINATES OF HURRICANE)
C    AND WHERE
C     LATITUDES, LONGITUDES AND BEARINGS ARE GIVEN IN DEGREES,
C     POSITIVE VALUES ARE NORTH AND WEST, NEGATIVE SOUTH AND EAST,
C     BEARINGS ARE GIVEN CLOCKWISE FROM NORTH.
C
C  THE CALL TO STHGPR SHOULD BE MADE ONCE ONLY, AND BEFORE REFERENCE
C  TO ANY CALL TO LL2XYH OR XY2LLH.  IN DEFAULT, THE SYSTEM
C  WILL ASSUME A STORM AT LAT,LONG=0.,0., BEARING DUE NORTH,
C  WITH A GRIDSIZE OF 120 NAUTICAL MILES AND OFFSETS OF 0.,0. .
C
C  TO CONVERT FROM GRID COORDINATES XI AND YJ, USE A CALL TO
C    CALL XY2LLH(XI,YJ,XLAT,XLONG)
C
C  THE SUBROUTINE WILL RETURN THE LATITUDE AND LONGITUDE CORRESPONDING
C  TO THE GIVEN VALUES OF XI AND YJ.
C
C  TO CONVERT FROM LATITUDE AND LONGITUDE TO GRID COORDINATES, USE
C    CALL LL2XYH(XLAT,XLONG,XI,YJ)
C  THE SUBROUTINE WILL RETURN THE I-COORDINATE XI AND Y-COORDINATE
C  YJ CORRESPONDING TO THE GIVEN VALUES OF LATITUDE XLAT AND
C  LONGITUDE XLONG.
      COMMON /HGRPRM/ A(3,3),RADPDG,RRTHNM,DGRIDH,HGRIDX,HGRIDY
      DATA A /0.,-1.,0., 1.,0.,0.,  0.,0.,1./
      DATA RADPDG/1.745 3293 E-2/,RRTHNM /3 440.17/
      DATA DGRIDH/120./
      DATA HGRIDX,HGRIDY/0.,0./
      END
cx**********************************************************************
cx    SUBROUTINE STHGPR(XLATH,XLONH,BEAR,GRIDSZ,XI0,YJ0)
cx  ALBION D. TAYLOR, MARCH 19, 1982
cx    COMMON /HGRPRM/ A(3,3),RADPDG,RRTHNM,DGRIDH,HGRIDX,HGRIDY
cx    CLAT=COS(RADPDG*XLATH)
cx    SLAT=SIN(RADPDG*XLATH)
cx    SLON=SIN(RADPDG*XLONH)
cx    CLON=COS(RADPDG*XLONH)
cx    SBEAR=SIN(RADPDG*BEAR)
cx    CBEAR=COS(RADPDG*BEAR)
cx    A(1,1)=   CLAT*SLON
cx    A(1,2)=   CLAT*CLON
cx    A(1,3)=   SLAT
cx    A(2,1)= - CLON*CBEAR + SLAT*SLON*SBEAR
cx    A(2,2)=   SLON*CBEAR + SLAT*CLON*SBEAR
cx    A(2,3)=              - CLAT*     SBEAR
cx    A(3,1)= - CLON*SBEAR - SLAT*SLON*CBEAR
cx    A(3,2)=   SLON*SBEAR - SLAT*CLON*CBEAR
cx    A(3,3)=                CLAT*     CBEAR
cx    DGRIDH=GRIDSZ
cx    HGRIDX=XI0
cx    HGRIDY=YJ0
cx    RETURN
cx    END
cx**********************************************************************
cx    SUBROUTINE LL2XYH(XLAT,XLONG,XI,YJ)
cx  ALBION D. TAYLOR, MARCH 19, 1982
cx    COMMON /HGRPRM/ A(3,3),RADPDG,RRTHNM,DGRIDH,HGRIDX,HGRIDY
cx    DIMENSION ZETA(3),ETA(3)
cx    CLAT=COS(RADPDG*XLAT)
cx    SLAT=SIN(RADPDG*XLAT)
cx    SLON=SIN(RADPDG*XLONG)
cx    CLON=COS(RADPDG*XLONG)
cx    ZETA(1)=CLAT*SLON
cx    ZETA(2)=CLAT*CLON
cx    ZETA(3)=SLAT
cx    DO 20 I=1,3
cx    ETA(I)=0.
cx    DO 20 J=1,3
cx    ETA(I)=ETA(I) + A(I,J)*ZETA(J)
cx 20 CONTINUE
cx    R=SQRT(ETA(1)*ETA(1) + ETA(3)*ETA(3))
cx    XI=HGRIDX+RRTHNM*ATAN2(ETA(2),R)/DGRIDH
cx    IF(R.LE.0.) GO TO 40
cx    YJ=HGRIDY+RRTHNM*ATAN2(ETA(3),ETA(1))/DGRIDH
cx    RETURN
cx 40 YJ=0.
cx    RETURN
cx    END
cx**********************************************************************
cx    SUBROUTINE XY2LLH(XI,YJ,XLAT,XLONG)
cx  ALBION D. TAYLOR, MARCH 19, 1982
cx    COMMON /HGRPRM/ A(3,3),RADPDG,RRTHNM,DGRIDH,HGRIDX,HGRIDY
cx    DIMENSION ZETA(3),ETA(3)
cx    CXI=COS(DGRIDH*(XI-HGRIDX)/RRTHNM)
cx    SXI=SIN(DGRIDH*(XI-HGRIDX)/RRTHNM)
cx    SYJ=SIN(DGRIDH*(YJ-HGRIDY)/RRTHNM)
cx    CYJ=COS(DGRIDH*(YJ-HGRIDY)/RRTHNM)
cx    ETA(1)=CXI*CYJ
cx    ETA(2)=SXI
cx    ETA(3)=CXI*SYJ
cx    DO 20 I=1,3
cx    ZETA(I)=0.
cx    DO 20 J=1,3
cx    ZETA(I)=ZETA(I) + A(J,I)*ETA(J)
cx 20 CONTINUE
cx    R=SQRT(ZETA(1)*ZETA(1) + ZETA(2)*ZETA(2))
cx    XLAT=ATAN2(ZETA(3),R)/RADPDG
cx    IF(R.LE.0.) GO TO 40
cx    XLONG=ATAN2(ZETA(1),ZETA(2))/RADPDG
cx    RETURN
cx 40 XLONG=0.
cx    RETURN
cx    END
cx**********************************************************************
cx    SUBROUTINE SETUP(P1,P2,P3,P4,P5,P6,P7,P8,P)
cx    DIMENSION P(166)
cxP1 THRU P8 ARE ARE 8 PRIMARY PREDICTORS WHERE...
cx     P1 IS INITIAL LATITUDE  (DEGS)
cx     P2 IS INITIAL LONGITUDE (DEGS)
cx     P3 IS JULIAN DAY NUMBER FUNCTION
cx     P4 IS MERIDIONAL DISPLACEMENT 00 TO -12H (NMI)
cx     P5 IS ZONAL DISPLACEMENT 00 TO -12H (NMI)
cx     P6 IS MERIDIONAL DISPLACEMENT 00 TO -24H (NMI)
cx     P7 IS ZONAL DISPLACEMENT 00 TO -24H (NMI)
cx     P8 IS MAXIMUM WIND (KNOTS)
cx
cxP(001 AND 002) ARE DUMMY VARIABLES AND ARE NOT FURTHER USED.
cx    DUMMY=9999.
cx    P(001)=DUMMY
cx    P(002)=DUMMY
cxP(003)THRU P(166) ARE ALL POSSIBLE PREDICTORS AS OBTAINED FROM CUBIC
cxPOLYNOMIAL EXPANSION OF ORIGINAL 8 BASIC PREDICTORS P1 THRU P8.
cxLIST THE PREDICTORS................
cx    P(003)=P8
cx    P(004)=P8*P8
cx    P(005)=P8*P8*P8
cx    P(006)=P7
cx    P(007)=P7*P8
cx    P(008)=P7*P8*P8
cx    P(009)=P7*P7
cx    P(010)=P7*P7*P8
cx    P(011)=P7*P7*P7
cx    P(012)=P6
cx    P(013)=P6*P8
cx    P(014)=P6*P8*P8
cx    P(015)=P6*P7
cx    P(016)=P6*P7*P8
cx    P(017)=P6*P7*P7
cx    P(018)=P6*P6
cx    P(019)=P6*P6*P8
cx    P(020)=P6*P6*P7
cx    P(021)=P6*P6*P6
cx    P(022)=P5
cx    P(023)=P5*P8
cx    P(024)=P5*P8*P8
cx    P(025)=P5*P7
cx    P(026)=P5*P7*P8
cx    P(027)=P5*P7*P7
cx    P(028)=P5*P6
cx    P(029)=P5*P6*P8
cx    P(030)=P5*P6*P7
cx    P(031)=P5*P6*P6
cx    P(032)=P5*P5
cx    P(033)=P5*P5*P8
cx    P(034)=P5*P5*P7
cx    P(035)=P5*P5*P6
cx    P(036)=P5*P5*P5
cx    P(037)=P4
cx    P(038)=P4*P8
cx    P(039)=P4*P8*P8
cx    P(040)=P4*P7
cx    P(041)=P4*P7*P8
cx    P(042)=P4*P7*P7
cx    P(043)=P4*P6
cx    P(044)=P4*P6*P8
cx    P(045)=P4*P6*P7
cx    P(046)=P4*P6*P6
cx    P(047)=P4*P5
cx    P(048)=P4*P5*P8
cx    P(049)=P4*P5*P7
cx    P(050)=P4*P5*P6
cx    P(051)=P4*P5*P5
cx    P(052)=P4*P4
cx    P(053)=P4*P4*P8
cx    P(054)=P4*P4*P7
cx    P(055)=P4*P4*P6
cx    P(056)=P4*P4*P5
cx    P(057)=P4*P4*P4
cx    P(058)=P3
cx    P(059)=P3*P8
cx    P(060)=P3*P8*P8
cx    P(061)=P3*P7
cx    P(062)=P3*P7*P8
cx    P(063)=P3*P7*P7
cx    P(064)=P3*P6
cx    P(065)=P3*P6*P8
cx    P(066)=P3*P6*P7
cx    P(067)=P3*P6*P6
cx    P(068)=P3*P5
cx    P(069)=P3*P5*P8
cx    P(070)=P3*P5*P7
cx    P(071)=P3*P5*P6
cx    P(072)=P3*P5*P5
cx    P(073)=P3*P4
cx    P(074)=P3*P4*P8
cx    P(075)=P3*P4*P7
cx    P(076)=P3*P4*P6
cx    P(077)=P3*P4*P5
cx    P(078)=P3*P4*P4
cx    P(079)=P3*P3
cx    P(080)=P3*P3*P8
cx    P(081)=P3*P3*P7
cx    P(082)=P3*P3*P6
cx    P(083)=P3*P3*P5
cx    P(084)=P3*P3*P4
cx    P(085)=P3*P3*P3
cx    P(086)=P2
cx    P(087)=P2*P8
cx    P(088)=P2*P8*P8
cx    P(089)=P2*P7
cx    P(090)=P2*P7*P8
cx    P(091)=P2*P7*P7
cx    P(092)=P2*P6
cx    P(093)=P2*P6*P8
cx    P(094)=P2*P6*P7
cx    P(095)=P2*P6*P6
cx    P(096)=P2*P5
cx    P(097)=P2*P5*P8
cx    P(098)=P2*P5*P7
cx    P(099)=P2*P5*P6
cx    P(100)=P2*P5*P5
cx    P(101)=P2*P4
cx    P(102)=P2*P4*P8
cx    P(103)=P2*P4*P7
cx    P(104)=P2*P4*P6
cx    P(105)=P2*P4*P5
cx    P(106)=P2*P4*P4
cx    P(107)=P2*P3
cx    P(108)=P2*P3*P8
cx    P(109)=P2*P3*P7
cx    P(110)=P2*P3*P6
cx    P(111)=P2*P3*P5
cx    P(112)=P2*P3*P4
cx    P(113)=P2*P3*P3
cx    P(114)=P2*P2
cx    P(115)=P2*P2*P8
cx    P(116)=P2*P2*P7
cx    P(117)=P2*P2*P6
cx    P(118)=P2*P2*P5
cx    P(119)=P2*P2*P4
cx    P(120)=P2*P2*P3
cx    P(121)=P2*P2*P2
cx    P(122)=P1
cx    P(123)=P1*P8
cx    P(124)=P1*P8*P8
cx    P(125)=P1*P7
cx    P(126)=P1*P7*P8
cx    P(127)=P1*P7*P7
cx    P(128)=P1*P6
cx    P(129)=P1*P6*P8
cx    P(130)=P1*P6*P7
cx    P(131)=P1*P6*P6
cx    P(132)=P1*P5
cx    P(133)=P1*P5*P8
cx    P(134)=P1*P5*P7
cx    P(135)=P1*P5*P6
cx    P(136)=P1*P5*P5
cx    P(137)=P1*P4
cx    P(138)=P1*P4*P8
cx    P(139)=P1*P4*P7
cx    P(140)=P1*P4*P6
cx    P(141)=P1*P4*P5
cx    P(142)=P1*P4*P4
cx    P(143)=P1*P3
cx    P(144)=P1*P3*P8
cx    P(145)=P1*P3*P7
cx    P(146)=P1*P3*P6
cx    P(147)=P1*P3*P5
cx    P(148)=P1*P3*P4
cx    P(149)=P1*P3*P3
cx    P(150)=P1*P2
cx    P(151)=P1*P2*P8
cx    P(152)=P1*P2*P7
cx    P(153)=P1*P2*P6
cx    P(154)=P1*P2*P5
cx    P(155)=P1*P2*P4
cx    P(156)=P1*P2*P3
cx    P(157)=P1*P2*P2
cx    P(158)=P1*P1
cx    P(159)=P1*P1*P8
cx    P(160)=P1*P1*P7
cx    P(161)=P1*P1*P6
cx    P(162)=P1*P1*P5
cx    P(163)=P1*P1*P4
cx    P(164)=P1*P1*P3
cx    P(165)=P1*P1*P2
cx    P(166)=P1*P1*P1
cx    RETURN
cx    END
C***********************************************************************
cx    SUBROUTINE YX2LL(ALAT0,ALON0,DISP,CFCST)
cxINCOMING ARGUMENTS:
cx    ALAT0, ALON0...INITIAL STORM POSTION
cx    DISP...........FORECAST MERIDIONAL & ZONAL DISPLACEMENTS IN NMI.
cxRETURNED ARGUMENT:
cx    CDISP..........FORECASTS IN TERMS OF LAT/LON
cx
cx    REAL*4 DISP(12),CFCST(12)
cx    CALL STHGPR(ALAT0,F1(ALON0),360.,1.,0.,0.)
cx    DO 10 I=1,6
cx    CALL XY2LLH(DISP(2*I),DISP(2*I-1),CFCST(2*I-1),CFCST(2*I))
cxNOTE: ABOVE SUBROUTINE RETURNS LONGITUDES WEST OF 180 AS NEGATIVE AND
cxEAST OF 180 AS POSITIVE.  CONVERT ALL LONGITUDES TO EAST
cxREMOVIT
cx    IF(CFCST(2*I).GE.0.AND.CFCST(2*I).LT.180.)CFCST(2*I)=360.-
cx   $CFCST(2*I)
cx    IF(CFCST(2*I).LT.0.)CFCST(2*I)=-CFCST(2*I)
cx 10 CONTINUE
cx    RETURN
cx    END
cx*********************************************************************
cx    FUNCTION NEWCYC(NOWCYC,N)
cxGIVEN CYCLE TIME NOWCYC, GET NEW CYCLE TIME (NEWCYC) GIVEN BY
cxNOWCYC + N HOURS.  LIMIT 0F N IS + OR - 744 HOURS.  ALLOWANCES
cxARE MADE FOR LEAP YEARS.
cx(C.J.NEUMANN, SAIC, OCTOBER, 1989)
cx    CHARACTER*8 ALFA
cx    INTEGER NHEM(15),NOLEAP(15),ADDYR
cx    DATA NOLEAP /000,744,1488,2160,2904,3624,4368,5088,5832,6576,7296,
cx   $8040,8760,9504,10248/
cxABOVE DATA STATEMENT GIVES NUMBER OF HOURS FOR NON-LEAP YEAR MONTHS
cxMONTHS 0000UTC ON 1 DEC THRU 0000UTC ON 1 FEB OF SECOND YEAR.
cx
cxOBTAIN YEAR (KYR),MONTH (M0),DAY (KDA) AND HOUR (JTM) IN INTEGER FORMAT
cx    WRITE(ALFA,'(I8)')NOWCYC
cx    READ(ALFA,'(4I2)')KYR,MO,KDA,JTM
cx    DO 10 I=1,15
cx 10 NHEM(I)=NOLEAP(I)
cxIS THIS A LEAP YEAR? (YEAR 2000 IS A LEAP YEAR)
cx    IF(MOD(KYR,4).EQ.0)THEN
cx    DO 20 I=4,15
cx 20 NHEM(I)=NHEM(I)+24
cx    ENDIF
cxHOW MANY HRS FROM BEGINNING OF TIME WINDOW AT 0000UTC, 1 DEC (NHROLD)?
cx    NHROLD=NHEM(MO+1)+(KDA-1)*24+JTM
cxHOW MANY HRS NEEDED FROM BEGINNING OF WINDOW (NHRNEW)?
cx    NHRNEW=NHROLD+N
cx
cx    DO 30 MO=2,15
cxMO = 2 = PREVIOUS YEAR; M0 = 15 = NEXT YEAR; DO WE NEED TO ADD OR
cxSUBTRACT A YEAR??
cx    KYRNEW=KYR-(2/MO)+MO/15
cxCHANGE OF CENTURY?
cx    IF(KYRNEW.EQ.100)KYRNEW=0
cx    IF(KYRNEW.EQ.-1)KYRNEW=99
cx
cx    IF(NHRNEW.LT.NHEM(MO))GOTO 40
cx 30 CONTINUE
cx 40 NDIF=NHRNEW-NHEM(MO-1)
cx    LDA=(NDIF+24)/24
cx    LTM=NDIF+24-(LDA*24)
cx    INDEX=MOD(MO-3,12)+(2/MO)*12+1
cx    NEWCYC=KYRNEW*1000000+INDEX*10000+LDA*100+LTM
cx    RETURN
cx    END
cx*******************************************************************8
cx    SUBROUTINE LL2DB(XLATO,XLONO,XLATT,XLONT,DIST,BEAR)
cx     ALBION D. TAYLOR MARCH 18, 1981
cx    DATA RRTHNM/3 440.17/,RADPDG/1.745 3293 E-2/
cx  RRTHNM=RADIUS OF EARTH IN NAUT. MILES, RADPDG==OF RADIANS
cx  PER DEGREE
cx---------------------------------------------------------------------*
cx GIVEN AN ORIGIN AT LATITUDE, LONGITUDE=XLATO,XLONO, WILL LOCATE     *
cx A TARGET POINT AT LATITUDE, LONGITUDE = XLATT, XLONT.  RETURNS      *
cx DISTANCE DIST IN NAUTICAL MILES, AND BEARING BEAR (DEGREES CLOCKWISE*
cx FROM NORTH).                                                        *
cx                                                                     *
cx ALL LATITUDES ARE IN DEGREES, NORTH POSITIVE AND SOUTH NEGATIVE.    *
cx ALL LONGITUDES ARE IN DEGREES, WEST POSITIVE AND EAST NEGATIVE.     *
cx                                                                     *
cx NOTE-- WHEN ORIGIN IS AT NORTH OR SOUTH POLE, BEARING IS NO LONGER  *
cx MEASURED FROM NORTH.  INSTEAD, BEARING IS MEASURED CLOCKWISE        *
cx FROM THE LONGITUDE OPPOSITE THAT SPECIFIED IN XLONO.                *
cx EXAMPLE-- IF XLATO=90., XLONO=80., THE OPPOSITE LONGITUDE IS -100.  *
cx (100 EAST), AND A TARGET AT BEARING 30. WILL LIE ON THE -70.        *
cx (70 EAST) MERIDIAN                                                  *
cx---------------------------------------------------------------------*
cx    CLATO=COS(RADPDG*XLATO)
cx    SLATO=SIN(RADPDG*XLATO)
cx    CLATT=COS(RADPDG*XLATT)
cx    SLATT=SIN(RADPDG*XLATT)
cx    CDLON=COS(RADPDG*(XLONT-XLONO))
cx    SDLON=SIN(RADPDG*(XLONT-XLONO))
cx    Z=SLATT*SLATO + CLATT*CLATO*CDLON
cx    Y= - CLATT*SDLON
cx    X=CLATO*SLATT - SLATO*CLATT*CDLON
cx    R=SQRT(X*X+Y*Y)
cx    DIST=RRTHNM*ATAN2(R,Z)
cx    IF (R.LE.0.) GO TO 20
cx    BEAR=ATAN2(-Y,-X)/RADPDG + 180.
cx    RETURN
cx 20 BEAR=0.
cx    RETURN
cx    END
C***********************************************************************
      BLOCK DATA BLKSE1
C
C ENTER ALL CONSTANTS NEEDED BY SEICPR PROGRAM......
C
      INTEGER*2
     $       N12M(16),N24M(16),N36M(16),N48M(16),N60M(16),N72M(16)
      INTEGER*2
     $       N12Z(14),N24Z(14),N36Z(14),N48Z(14),N60Z(14),N72Z(14)
      REAL*4 R12M(16),R24M(16),R36M(16),R48M(16),R60M(16),R72M(16)
      REAL*4 R12Z(14),R24Z(14),R36Z(14),R48Z(14),R60Z(14),R72Z(14)
      COMMON/BLOCKSE1/RCM(16,6),RCZ(14,6),CNSTM(6),CNSTZ(6)
      INTEGER*2 NPM(16,6),NPZ(14,6)
      COMMON/BLOCKSE2/NPM,NPZ
C
      EQUIVALENCE
     $(N12M(1),NPM(1,1)),(N24M(1),NPM(1,2)),(N36M(1),NPM(1,3))
      EQUIVALENCE
     $(N48M(1),NPM(1,4)),(N60M(1),NPM(1,5)),(N72M(1),NPM(1,6))
      EQUIVALENCE
     $(N12Z(1),NPZ(1,1)),(N24Z(1),NPZ(1,2)),(N36Z(1),NPZ(1,3))
      EQUIVALENCE
     $(N48Z(1),NPZ(1,4)),(N60Z(1),NPZ(1,5)),(N72Z(1),NPZ(1,6))
C
      EQUIVALENCE
     $(R12M(1),RCM(1,1)),(R24M(1),RCM(1,2)),(R36M(1),RCM(1,3))
      EQUIVALENCE
     $(R48M(1),RCM(1,4)),(R60M(1),RCM(1,5)),(R72M(1),RCM(1,6))
      EQUIVALENCE
     $(R12Z(1),RCZ(1,1)),(R24Z(1),RCZ(1,2)),(R36Z(1),RCZ(1,3))
      EQUIVALENCE
     $(R48Z(1),RCZ(1,4)),(R60Z(1),RCZ(1,5)),(R72Z(1),RCZ(1,6))
C
C  12HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R12M/
     A .6500266E+0, .4346360E-5,-.1586378E-5, .1144783E-4, .5048783E-5,
     B .2668805E-3,-.1150471E-4, .2681863E-5,-.4829064E-4,-.9490418E-5,
     C .1263979E-4,-.3055094E-5,-.1968997E-5, .1506849E-5, .2188557E-6,
     D-.2363125E-6/
C
C  12HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N12M/
     A         037,         053,         017,         071,         100,
     B         138,         110,         056,         157,         014,
     C         065,         062,         026,         121,         091,
     D         042/
C
C  24HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R24M/
     A .6670975E-3, .9767612E+0,-.4016455E-5, .2219380E-4, .3137972E-5,
     B-.3051675E-4, .2629791E-4,-.2129713E-4,-.8695877E-4, .7082292E-5,
     C-.7412803E-5, .2748492E-4,-.1680689E-5, .7428285E-5,-.3940199E-5,
     D-.1566399E-5/
C
C  24HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N24M/
     A         138,         037,         017,         056,         091,
     B         110,         053,         014,         157,         100,
     C         026,         065,         042,         071,         062,
     D         121/
C
C  36HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R36M/
     A .1250097E-2,-.3822699E-4,-.4209243E-5,-.1356181E-3, .5742563E-5,
     B .9596518E+0, .3140751E-4,-.4294882E-4, .5567016E-4,-.7244950E-5,
     C-.1478741E-4, .9795566E-5,-.6965742E-5,-.9348780E-5, .2514677E-4,
     D-.7001534E-5/
C
C  36HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N36M/
     A         138,         014,         017,         157,         091,
     B         037,         056,         110,         053,         042,
     C         026,         100,         062,         121,         065,
     D         071/
C
C  48HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R48M/
     A .1815626E-2,-.1489150E-4, .1158459E+1,-.7293896E-4,-.2011209E-4,
     B-.2939316E-4, .5922391E-5,-.2560332E-4,-.2025014E-3,-.4017675E-4,
     C .1188901E-4, .1556017E-4,-.9906227E-5, .2288921E-4,-.4250887E-5,
     D .2646512E-6/
C
C  48HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N48M/
     A         138,         042,         037,         110,         121,
     B         062,         091,         026,         157,         014,
     C         100,         056,         071,         065,         053,
     D         017/
C
C  60HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R60M/
     A .2067777E-2,-.1384777E-3,-.3541299E-3,-.6422765E-4,-.3528279E-4,
     B .1111489E+1,-.1282683E-4, .4729876E-5,-.2850844E-4, .1535681E-4,
     C-.4623132E-4, .2807974E-4,-.4005565E-4,-.6783397E-5, .5561948E-6,
     D .7085590E-5/
C
C  60HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N60M/
     A         138,         065,         157,         062,         026,
     B         037,         042,         091,         121,         100,
     C         110,         056,         071,         014,         017,
     D         053/
C
C  72HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R72M/
     A .2259347E-2,-.3210257E-3,-.8231678E-4,-.4438970E-3,-.4845527E-4,
     B .1471507E-4,-.9748230E-5, .1188192E-3,-.1123290E-3, .6557345E-4,
     C .7651687E-5,-.3061854E-4, .5066699E+0, .2636657E-4,-.1313600E-5,
     D-.1035049E-4/
C
C  72HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N72M/
     A         138,         065,         062,         157,         026,
     B         100,         042,         053,         071,         056,
     C         091,         121,         037,         014,         017,
     D         110/
C
C    12 THROUGH 72HR MERIDIONAL INTERCEPT VALUES
      DATA CNSTM/
     $ .19093E+2, .55071E+2, .11086E+3, .18268E+3, .27011E+3, .33529E+3/
C
C  12HR ZONAL REGRESSION COEFFICIENTS
      DATA R12Z/
     A .1296249E+1, .8375126E-5,-.1378439E+0,-.1327108E-4, .2397764E-4,
     B-.2489660E-5, .8464961E-2,-.2047595E+0,-.7229803E-4, .2126735E-4,
     C-.3955738E-5, .3863061E-2, .7852138E-5, .5536868E-4/
C
C  12HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N12Z/
     A         022,         044,         006,         042,         049,
     B         036,         166,         158,         152,         084,
     C         117,         125,         053,         089/
C
C  24HR ZONAL REGRESSION COEFFICIENTS
      DATA R24Z/
     A .2528738E+1, .2169040E-4,-.4290250E+0, .2484030E-1,-.6118201E-5,
     B-.5986292E+0,-.2447727E-4, .4172904E-4, .9053409E-4,-.1539276E-4,
     C-.3145838E-3, .2625315E-4, .2009991E-1, .1955873E-2/
C
C  24HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N24Z/
     A         022,         053,         006,         166,         036,
     B         158,         042,         049,         084,         117,
     C         152,         044,         125,         089/
C
C  36HR ZONAL REGRESSION COEFFICIENTS
      DATA R36Z/
     A .3506600E+1, .4677240E-1, .6067485E-2, .2020475E-3,-.1054669E-4,
     B-.2988771E-4, .4541072E-4,-.1097270E+1,-.1025092E-2,-.2096134E-4,
     C .3237902E-4, .7223325E-1,-.6436815E+0, .2281674E-4/
C
C  36HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N36Z/
     A         022,         166,         089,         084,         036,
     B         117,         044,         158,         152,         042,
     C         049,         125,         006,         053/
C
C  48HR ZONAL REGRESSION COEFFICIENTS
      DATA R48Z/
     A .4371525E+1, .6868443E-1,-.9669937E-2, .3271418E-3,-.4574040E-4,
     B-.1046727E-4,-.1574199E+1,-.1356174E-3, .7263980E-4, .1305655E+1,
     C-.2078065E-4, .3972008E-4,-.5117910E-1,-.3080416E-4/
C
C  48HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N48Z/
     A         022,         166,         089,         084,         117,
     B         036,         158,         152,         044,         006,
     C         042,         049,         125,         053/
C
C  60HR ZONAL REGRESSION COEFFICIENTS
      DATA R60Z/
     A .4757084E+1, .8786910E-1,-.1940565E+1, .6936690E-3, .4315261E-3,
     B-.5061832E-4,-.7381739E-5, .6156225E-4,-.1702064E-1, .5585419E-4,
     C-.2396341E-4,-.1508715E+0, .2208045E+1,-.4975949E-5/
C
C  60HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N60Z/
     A         022,         166,         158,         152,         084,
     B         117,         036,         053,         089,         049,
     C         042,         125,         006,         044/
C
C  72HR ZONAL REGRESSION COEFFICIENTS
      DATA R72Z/
     A .5412447E+1, .1236903E+0,-.2725503E+1,-.1207977E+0, .5459844E-3,
     B-.6757351E-4,-.7194847E-5, .1144012E-3, .4378634E-3, .6353992E-4,
     C-.2713346E-4,-.3563588E-4, .1248191E+1,-.1034481E-1/
C
C  72HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N72Z/
     A         022,         166,         158,         125,         084,
     B         117,         036,         053,         152,         049,
     C         042,         044,         006,         089/
C
C    12 THROUGH 72HR ZONAL INTERCEPT VALUES
      DATA CNSTZ/
     $ .11519E+2, .32226E+2, .51082E+2, .66364E+2, .58771E+2, .86333E+2/
      END
