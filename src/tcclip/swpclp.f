C***********************************************************************
C
      SUBROUTINE SWPCLP(IDATIM,ALAT00,ALON00,ALAT12,ALON12,ALAT24,
     $ALON24,WIND,DISP,CFCST,P1TOP8)
C
C Developed by:
C Charles J. Neumann, Science Applications International Corporation, 
C June, 2000.   (revised 10/25/00)
C
C Installed in ATCF3.5:
C Sampson, NRL (5/1/01)  
C
C Documentation:
C SAIC Final Report on the Southwest Pacific CLIPER Model (SWCLP)
C October, 2000
C
C
C THIS IS A CLIPER PROGRAM FOR THE EAST AUSTRALIA\SW PACIFIC OCEAN BASIN.  
C THE FOLLOWING SHOULD BE NOTED:
C (1) PROGRAM WAS DEVELOPED USING STORM TRACKS OVER YEARS 1970/1971 TO
C     1998/1999
C (2) DEVELOPMENTAL DATA SET INCLUDED ALL DATES EXCEPT JULY 1 THROUGH
C     SEPTEMBER 15.
C (3) ANY STORMS HAVING POSITIONS WEST OF 142E WERE EXCLUDED FROM
C     DEVELOPMENTAL DATA SET.  NUMBER OF TC'S INCLUDED = 296
C (4) STORMS POSITIONS SOUTH OF 50S WERE EXCLUDED FROM DEVELOPMENTAL
C     DATA SET.
C (5) STORMS WHICH INITIALLY CLASSIFIED AS DEPRESSIONS OR CLASSIFIED AS
C     DEPRESSIONS AT VERIFICATION TIME WERE EXCLUDED.
C (6) SAMPLE SIZE,  4619 AT 12H,  4075 AT 24H,  3588 AT 36H,
C                   3125 AT 48H,  2698 AT 60H,  2307 AT 72H.
C (7) INDIVIDUAL CASES IN DEVELOPMENTAL DATA SET WERE AT 6 HRLY INTERVALS
C
C INCOMING ARGUMENTS ARE AS FOLLOWS:
C   IDATIM (INTEGER*4) IS IN FORM YY/MO/DA/HR AS 01040106 FOR
C   DATE APRIL 1, 2001.
C   ALAT00 AND ALON00 ARE INITIAL STORM POSITION (REAL*4)
C   ALAT12 AND ALON12 ARE POSITION 12H EARLIER   (REAL*4)
C   ALAT24 AND ALON24 ARE POSITION 24H EARLIER   (REAL*4)
C     NOTE: IT IS ASSUMED THAT S LATITUDES AND E LONGITUDES WILL BE 
C     ENTERED AS POSITIVE VALUES.
C   WIND IS MAXIMUM WIND (1-MINUTE AVERAGE) NEAR STORM CENTER IN KNOTS
C   (REAL*4).
C
C RETURNED ARGUMENTS ARE:
C   STORM DISPLACEMENTS AS GIVEN BY (DISP(J),J=1,12);
C   POSITIONS AS GIVEN BY (CDISP(J),J=1,12);
C   VALUES OF 8 BASIC PREDICTORS AS GIVEN BY (P1TOP8(K),K=1,8)
C
C ARRANGEMENT OF DISP AND CDISP ARRAY IS AS FOLLOWS:
C      DISP(01) IS MERIDIONAL 12H DISPLACEMENT (NMI)
C      DISP(02) IS ZONAL 12H DISPLACEMENT (NMI)
C      DISP(03) IS MERIDIONAL 24H DISPLACEMENT (NMI)
C      DISP(04) IS ZONAL 24H DISPLACEMENT (NMI)
C      DISP(05) IS MERIDIONAL 36H DISPLACEMENT (NMI)
C      DISP(06) IS ZONAL 36H DISPLACEMENT (NMI)
C      DISP(07) IS MERIDIONAL 48H DISPLACEMENT (NMI)
C      DISP(08) IS ZONAL 48H DISPLACEMENT (NMI)
C      DISP(09) IS MERIDIONAL 60H DISPLACEMENT (NMI)
C      DISP(10) IS ZONAL 60H DISPLACEMENT (NMI)
C      DISP(11) IS MERIDIONAL 72H DISPLACEMENT (NMI)
C      DISP(12) IS ZONAL 72H DISPLACEMENT (NMI)
C NOTE: NEGATIVE DISPLACEMENTS ARE TOWARDS WEST OR SOUTH.
C       CDISP ARRAY CORRESPONDS TO DISP ARRAY EXCEPT THAT DISPLACEMENTS
C       HAVE BEEN CONVERTED TO LATITUDES SOUTH AND LONGITUDES EAST
C
      COMMON/BLOCKSW1/RCM(31,6),RCZ(31,6),CNSTM(6),CNSTZ(6)
      INTEGER*2 NPM(31,6),NPZ(31,6)
      COMMON/BLOCKSW2/NPM,NPZ
      REAL*4 P(166),DISP(12),CFCST(12),P1TOP8(8)
C INITIALLY, 008 PREDICTORS OUT OF 164 POSSIBLE PREDICTORS (LISTED IN
C SUBROUTINE SETUP) WERE SELECTED FOR EACH TIME PERIOD AND FOR BOTH ZONAL
C AND MERIDIONAL MOTION.  A FINAL SET OF PREDICTORS FOR EACH COMPONENT OF
C MOTION INCLUDED ALL PREDICTORS SELECTED AT LEAST ONCE, 12 THRU 72H.
C THIS TURNED OUT TO BE 31 PREDICTORS FOR MERIDIONAL MOTION AND 31 FOR
C ZONAL MOTION.
C
C ALL REGRESSION COEFFICIENTS ARE PREDICTOR NUMBERS ARE CONTAINED IN
C BLOCK DATA BLKSW1.  THERE ARE 31 PREDICTORS AND PREDICTOR
C NUMBERS FOR MERIDIONAL MOTION AND 31 PREDICTORS AND PREDICTOR NUMBERS
C FOR ZONAL MOTION. ((RCM(I,J),J=1,6,I=1,31) & ((NPM(I,J),J=1,6),I=1,31)
C ARE COEFFICEINTS AND PREDICTOR NUMBERS FOR MERIDIONAL MOTION WHILE
C ((RCZ(I,J),J=1,6,I=1,31) AND ((NPZ(I,J),J=1,6),I=1,31) ARE COEFFICIENTS
C AND PREDICTOR NUMBERS FOR ZONAL MOTION. SUBSCRIPT J REFERS TO TIME WHERE
C J=1=12H.........J=6=72H.
C 6 MERIDIONAL INTERCEPT VALUES ARE GIVEN BY (CNSTM(J),J=1,6) WHILE THE
C 6 ZONAL INTERCEPT VALUES ARE GIVEN BY (CNSTZ(J),J=1,6).
C P1 THRU P8 ARE 8 PRIMARY PREDICTORS WHERE...
C    P1 IS INITIAL LATITUDE  (DEGS SOUTH)
C    P2 IS INITIAL LONGITUDE (DEGS EAST)
C    P3 IS JULIAN DAY NUMBER FUNCTION DEFINED AS NUMBER OF DAYS (ABSOLUTE)
C          EITHER SIDE OF MARCH 1 (APPROXIMATE MID-SEASON FOR THIS AREA).
C    P4 IS MERIDIONAL DISPLACEMENT 00 TO -12H (NMI)
C    P5 IS ZONAL DISPLACEMENT 00 TO -12H (NMI)
C    P6 IS MERIDIONAL DISPLACEMENT 00 TO -24H (NMI)
C    P7 IS ZONAL DISPLACEMENT 00 TO -24H (NMI)
C    P8 IS MAXIMUM WIND (KNOTS) ASSUMING A 1-MINUTE WIND MEASURING
C          SYSTEM.
C FUNCTIONS AND SUBPROGRAMS NEEDED BY SWPCLP ARE AS FOLLOWS:
C    DATA NEEDED BY PROGRAM ARE CONTAINED IN BLOCK DATA BLKSW1 AND BLKSW2
C    SWPCLP CALLS SUBROUTINES STHGPR, LL2XYH, SETUP, YX2LL AND UPRCAS
C           AND UTILIZES FUNCTIONS F1, F2
C    YX2LL CALLS SUBROUTINE XY2LLH AND UTILIZES FUNCTION F1
C SET UP 8 BASIC PREDICTORS......
      P1=ALAT00
      P2=ALON00
C JULIAN DAY NUMBER
      DANBR=F2(IDATIM)
      IDN=DANBR+.5
C AVERAGE TC DAY NUMBER FOR THIS BASIN IS NEAR 60 (1 MARCH)
      MEANDN=60
C PUT OFF-SEASON DAY NUMBERS IN ALLOWABLE RANGE
      IF(IDN.GT.181.AND.IDN.LE.220)IDN=181
      IF(IDN.GT.220.AND.IDN.LT.259)IDN=259
C
      IF(IDN.GE.1.AND.IDN.LE.181)IDADIF=IABS(MEANDN-IDN)
      IF(IDN.GE.259)IDADIF=366-IDN+MEANDN
      P3=IDADIF
      P8=WIND
C USE AL TAYLOR ROUTINE FOR CONVERTING LATITUDE/LONGITUDE TO DISPLACEMENTS.
C THIS SAME ROUTINE IS LATER USED FOR CONVERTING DISPLACEMENTS BACK TO
C LATITUDES AND LONGITUDES........
C (PREDICTORS NUMBER P4 THRU P7)
      CALL STHGPR(P1,F1(P2),360.,1.,0.,0.)
      CALL LL2XYH(ALAT12,F1(ALON12),P5,P4)
      CALL LL2XYH(ALAT24,F1(ALON24),P7,P6)
C CHANGE SIGN
      P4=-P4
      P5=-P5
      P6=-P6
      P7=-P7
C BASIC PREDICTOR SETUP IS COMPLETE. PUT 8 VALUES INTO ARRAY P1TOP8 FOR
C POSSIBLE USE IN CALLING PROGRAM
      P1TOP8(1)=P1
      P1TOP8(2)=P2
      P1TOP8(3)=P3
      P1TOP8(4)=P4
      P1TOP8(5)=P5
      P1TOP8(6)=P6
      P1TOP8(7)=P7
      P1TOP8(8)=P8
C
C PREPARE FORECAST, FIRST, OBTAIN ALL POSSIBLE 3RD ORDER PRODUCTS AND
C CROSS-PRODUCTS OF THE 8 BASIC PREDICTORS AND RETURN THESE IN ARRAY
C (P(L),L=1,166).  THERE ARE 164 POSSIBLE COMBINATIONS AND THESE ARE
C GIVEN BY SUBSCRIPTS 3 THROUGH 166. P(1) AND P(2) ARE NOT USED AND HAVE
C BEEN RETURNED AS DUMMY VARIABLES. NOT ALL OF THE 164 POSSIBLE PREDICTORS
C ARE USED IN PROGRAM.
      CALL SETUP(P1,P2,P3,P4,P5,P6,P7,P8,P)
C OBTAIN FORECAST MERIDIONAL DISPLACEMENTS 12 THRU 72H
      DO 60 J=1,6
C INITIALIZE COMPUTATION WITH INTERCEPT VALUE
      DISP(2*J-1)=CNSTM(J)
      DO 50 I=1,31
      K=NPM(I,J)
      DISP(2*J-1)=DISP(2*J-1)+RCM(I,J)*P(K)
   50 CONTINUE
   60 CONTINUE
C
C OBTAIN FORECAST ZONAL DISPLACEMENTS 12 THRU 72H
C
      DO 80 J=1,6
C INITIALIZE COMPUTATION WITH INTERCEPT VALUE
      DISP(2*J)=CNSTZ(J)
      DO 70 I=1,31
      K=NPZ(I,J)
      DISP(2*J)=DISP(2*J)+RCZ(I,J)*P(K)
   70 CONTINUE
   80 CONTINUE
C CONVERT DISPLACEMENTS TO LATITUDE AND LONGITUDE
      CALL YX2LL(ALAT00,ALON00,DISP,CFCST)
C REVERSE SIGN OF LATITUDINAL DISPLACEMENTS
      DO 90 J=1,11,2
   90 DISP(J)=-DISP(J)
      RETURN
      END
cx**********************************************************************
cx    FUNCTION F1(ALON)
cxCONVERT FROM E LONGITUDE TO THOSE ACCEPTABLE IN AL TAYLOR ROUTINES
cx    IF(ALON.GT.180.)F1=360.-ALON
cx    IF(ALON.LE.180.)F1=-ALON
cx    RETURN
cx    END
cx**********************************************************************
cx    FUNCTION F2(IDATIM)
cxOBTAIN JULIAN DAY NUMBER
cx0000UTC ON 1 JAN IS SET TO DAY NUMBER 0 AND 1800UTC ON 31 DEC IS SET TO
cxDAY NUMBER 364.75.  LEAP YEARS ARE IGNORED.
cx    CHARACTER*8 ALFA
cx    WRITE(ALFA,'(I8)')IDATIM
cx    READ(ALFA,'(4I2)')KYR,MO,KDA,KHR
cx    MON=MO
cx    IF(MON.EQ.13)MON=1
cx    DANBR=3055*(MON+2)/100-(MON+10)/13*2-91+KDA
cx    F2=DANBR-1.+FLOAT(KHR/6)*0.25
cx    RETURN
cx    END
C***********************************************************************
      BLOCK DATA BLKSW2
C
C   ALBION D. TAYLOR, MARCH 19, 1982
C  THE HURRICANE GRID IS BASED ON AN OBLIQUE EQUIDISTANT CYLINDRICAL
C  MAP PROJECTION ORIENTED ALONG THE TRACK OF THE HURRICANE.
C
C    THE X (OR I) COORDINATE XI OF A POINT REPRESENTS THE DISTANCE
C  FROM THAT POINT TO THE GREAT CIRCLE THROUGH THE HURRICANE, IN
C  THE DIRECTION OF MOTION OF THE HURRICANE MOTION.  POSITIVE VALUES
C  REPRESENT DISTANCES TO THE RIGHT OF THE HURRICANE MOTION, NEGATIVE
C  VALUES REPRESENT DISTANCES TO THE LEFT.
C    THE Y (OR J) COORDINATE OF THE POINT REPRESENTS THE DISTANCE
C  ALONG THE GREAT CIRCLE THROUGH THE HURRICANE TO THE PROJECTION
C  OF THE POINT ONTO THAT CIRCLE.  POSITIVE VALUES REPRESENT
C  DISTANCE IN THE DIRECTION OF HURRICANE MOTION, NEGATIVE VALUES
C  REPRESENT DISTANCE IN THE OPPOSITE DIRECTION.
C
C     SCALE DISTANCES ARE STRICTLY UNIFORM IN THE I-DIRECTION ALWAYS.
C  THE SAME SCALE HOLDS IN THE J-DIRECTION ONLY ALONG THE HURRICANE TRACK
C  ELSEWHERE, DISTANCES IN THE J-DIRECTION ARE EXAGGERATED BY A FACTOR
C  INVERSELY PROPORTIONAL TO THE COSINE OF THE ANGULAR DISTANCE FROM
C  THE TRACK.  THE SCALE IS CORRECT TO 1 PERCENT WITHIN A DISTANCE OF
C  480 NM OF THE STORM TRACK, 5 PERCENT WITHIN 1090 NM, AND
C  10 PERCENT WITHIN 1550 NM.
C
C  BIAS VALUES ARE ADDED TO THE XI AND YJ COORDINATES FOR CONVENIENCE
C  IN INDEXING.
C
C  A PARTICULAR GRID IS SPECIFIED BY THE USER BY MEANS OF A CALL
C  TO SUBROUTINE STHGPR (SET HURRICANE GRID PARAMETERS)
C  WITH ARGUMENTS (XLATH,XLONH,BEAR,GRIDSZ,XIO,YJO)
C   WHERE
C     XLATH,XLONH = LATITUDE, LONGITUDE OF THE HURRICANE
C     BEAR        = BEARING OF THE HURRICANE MOTION
C     GRIDSZ      = SIZE OF GRID ELEMENTS IN NAUTICAL MILES
C     XIO, YJO    = OFFSETS IN I AND J COORDINATES (OR I AND J
C                     COORDINATES OF HURRICANE)
C    AND WHERE
C     LATITUDES, LONGITUDES AND BEARINGS ARE GIVEN IN DEGREES,
C     POSITIVE VALUES ARE NORTH AND WEST, NEGATIVE SOUTH AND EAST,
C     BEARINGS ARE GIVEN CLOCKWISE FROM NORTH.
C
C  THE CALL TO STHGPR SHOULD BE MADE ONCE ONLY, AND BEFORE REFERENCE
C  TO ANY CALL TO LL2XYH OR XY2LLH.  IN DEFAULT, THE SYSTEM
C  WILL ASSUME A STORM AT LAT,LONG=0.,0., BEARING DUE NORTH,
C  WITH A GRIDSIZE OF 120 NAUTICAL MILES AND OFFSETS OF 0.,0. .
C
C  TO CONVERT FROM GRID COORDINATES XI AND YJ, USE A CALL TO
C    CALL XY2LLH(XI,YJ,XLAT,XLONG)

C  THE SUBROUTINE WILL RETURN THE LATITUDE AND LONGITUDE CORRESPONDING
C  TO THE GIVEN VALUES OF XI AND YJ.
C
C  TO CONVERT FROM LATITUDE AND LONGITUDE TO GRID COORDINATES, USE
C    CALL LL2XYH(XLAT,XLONG,XI,YJ)
C  THE SUBROUTINE WILL RETURN THE I-COORDINATE XI AND Y-COORDINATE
C  YJ CORRESPONDING TO THE GIVEN VALUES OF LATITUDE XLAT AND
C  LONGITUDE XLONG.
      COMMON /HGRPRM/ A(3,3),RADPDG,RRTHNM,DGRIDH,HGRIDX,HGRIDY
      DATA A /0.,-1.,0., 1.,0.,0.,  0.,0.,1./
      DATA RADPDG/1.745 3293 E-2/,RRTHNM /3 440.17/
      DATA DGRIDH/120./
      DATA HGRIDX,HGRIDY/0.,0./
      END
cx**********************************************************************
cx    SUBROUTINE STHGPR(XLATH,XLONH,BEAR,GRIDSZ,XI0,YJ0)
cx  ALBION D. TAYLOR, MARCH 19, 1982
cx    COMMON /HGRPRM/ A(3,3),RADPDG,RRTHNM,DGRIDH,HGRIDX,HGRIDY
cx    CLAT=COS(RADPDG*XLATH)
cx    SLAT=SIN(RADPDG*XLATH)
cx    SLON=SIN(RADPDG*XLONH)
cx    CLON=COS(RADPDG*XLONH)
cx    SBEAR=SIN(RADPDG*BEAR)
cx    CBEAR=COS(RADPDG*BEAR)
cx    A(1,1)=   CLAT*SLON
cx    A(1,2)=   CLAT*CLON
cx    A(1,3)=   SLAT
cx    A(2,1)= - CLON*CBEAR + SLAT*SLON*SBEAR
cx    A(2,2)=   SLON*CBEAR + SLAT*CLON*SBEAR
cx    A(2,3)=              - CLAT*     SBEAR
cx    A(3,1)= - CLON*SBEAR - SLAT*SLON*CBEAR
cx    A(3,2)=   SLON*SBEAR - SLAT*CLON*CBEAR
cx    A(3,3)=                CLAT*     CBEAR
cx    DGRIDH=GRIDSZ
cx    HGRIDX=XI0
cx    HGRIDY=YJ0
cx    RETURN
cx    END
cx**********************************************************************
cx    SUBROUTINE LL2XYH(XLAT,XLONG,XI,YJ)
cx  ALBION D. TAYLOR, MARCH 19, 1982
cx    COMMON /HGRPRM/ A(3,3),RADPDG,RRTHNM,DGRIDH,HGRIDX,HGRIDY
cx    DIMENSION ZETA(3),ETA(3)
cx    CLAT=COS(RADPDG*XLAT)
cx    SLAT=SIN(RADPDG*XLAT)
cx    SLON=SIN(RADPDG*XLONG)
cx    CLON=COS(RADPDG*XLONG)
cx    ZETA(1)=CLAT*SLON
cx    ZETA(2)=CLAT*CLON
cx    ZETA(3)=SLAT
cx    DO 20 I=1,3
cx    ETA(I)=0.
cx    DO 20 J=1,3
cx    ETA(I)=ETA(I) + A(I,J)*ZETA(J)
cx 20 CONTINUE
cx    R=SQRT(ETA(1)*ETA(1) + ETA(3)*ETA(3))
cx    XI=HGRIDX+RRTHNM*ATAN2(ETA(2),R)/DGRIDH
cx    IF(R.LE.0.) GO TO 40
cx    YJ=HGRIDY+RRTHNM*ATAN2(ETA(3),ETA(1))/DGRIDH
cx    RETURN
cx 40 YJ=0.
cx    RETURN
cx    END
cx *********************************************************************
cx    SUBROUTINE XY2LLH(XI,YJ,XLAT,XLONG)
cx  ALBION D. TAYLOR, MARCH 19, 1982
cx    COMMON /HGRPRM/ A(3,3),RADPDG,RRTHNM,DGRIDH,HGRIDX,HGRIDY
cx    DIMENSION ZETA(3),ETA(3)
cx    CXI=COS(DGRIDH*(XI-HGRIDX)/RRTHNM)
cx    SXI=SIN(DGRIDH*(XI-HGRIDX)/RRTHNM)
cx    SYJ=SIN(DGRIDH*(YJ-HGRIDY)/RRTHNM)
cx    CYJ=COS(DGRIDH*(YJ-HGRIDY)/RRTHNM)
cx    ETA(1)=CXI*CYJ
cx    ETA(2)=SXI
cx    ETA(3)=CXI*SYJ
cx    DO 20 I=1,3
cx    ZETA(I)=0.
cx    DO 20 J=1,3
cx    ZETA(I)=ZETA(I) + A(J,I)*ETA(J)
cx 20 CONTINUE
cx    R=SQRT(ZETA(1)*ZETA(1) + ZETA(2)*ZETA(2))
cx    XLAT=ATAN2(ZETA(3),R)/RADPDG
cx    IF(R.LE.0.) GO TO 40
cx    XLONG=ATAN2(ZETA(1),ZETA(2))/RADPDG
cx    RETURN
cx 40 XLONG=0.
cx    RETURN
cx    END
C***********************************************************************
      SUBROUTINE SETUP(P1,P2,P3,P4,P5,P6,P7,P8,P)
      DIMENSION P(166)
C P1 THRU P8 ARE ARE 8 PRIMARY PREDICTORS WHERE...
C      P1 IS INITIAL LATITUDE  (DEGS)
C      P2 IS INITIAL LONGITUDE (DEGS)
C      P3 IS JULIAN DAY NUMBER FUNCTION (O TO 1.00)
C      P4 IS MERIDIONAL DISPLACEMENT 00 TO -12H (NMI)
C      P5 IS ZONAL DISPLACEMENT 00 TO -12H (NMI)
C      P6 IS MERIDIONAL DISPLACEMENT 00 TO -24H (NMI)
C      P7 IS ZONAL DISPLACEMENT 00 TO -24H (NMI)
C      P8 IS MAXIMUM WIND (KNOTS)
C
C P(001 AND 002) ARE DUMMY VARIABLES AND ARE NOT FURTHER USED.
      DUMMY=9999.
      P(001)=DUMMY
      P(002)=DUMMY
C P(003)THRU P(166) ARE ALL POSSIBLE PREDICTORS AS OBTAINED FROM CUBIC
C POLYNOMIAL EXPANSION OF ORIGINAL 8 BASIC PREDICTORS P1 THRU P8.
C LIST THE PREDICTORS................
      P(003)=P8
      P(004)=P8*P8
      P(005)=P8*P8*P8
      P(006)=P7
      P(007)=P7*P8
      P(008)=P7*P8*P8
      P(009)=P7*P7
      P(010)=P7*P7*P8
      P(011)=P7*P7*P7
      P(012)=P6
      P(013)=P6*P8
      P(014)=P6*P8*P8
      P(015)=P6*P7
      P(016)=P6*P7*P8
      P(017)=P6*P7*P7
      P(018)=P6*P6
      P(019)=P6*P6*P8
      P(020)=P6*P6*P7
      P(021)=P6*P6*P6
      P(022)=P5
      P(023)=P5*P8
      P(024)=P5*P8*P8
      P(025)=P5*P7
      P(026)=P5*P7*P8
      P(027)=P5*P7*P7
      P(028)=P5*P6
      P(029)=P5*P6*P8
      P(030)=P5*P6*P7
      P(031)=P5*P6*P6
      P(032)=P5*P5
      P(033)=P5*P5*P8
      P(034)=P5*P5*P7
      P(035)=P5*P5*P6
      P(036)=P5*P5*P5
      P(037)=P4
      P(038)=P4*P8
      P(039)=P4*P8*P8
      P(040)=P4*P7
      P(041)=P4*P7*P8
      P(042)=P4*P7*P7
      P(043)=P4*P6
      P(044)=P4*P6*P8
      P(045)=P4*P6*P7
      P(046)=P4*P6*P6
      P(047)=P4*P5
      P(048)=P4*P5*P8
      P(049)=P4*P5*P7
      P(050)=P4*P5*P6
      P(051)=P4*P5*P5
      P(052)=P4*P4
      P(053)=P4*P4*P8
      P(054)=P4*P4*P7
      P(055)=P4*P4*P6
      P(056)=P4*P4*P5
      P(057)=P4*P4*P4
      P(058)=P3
      P(059)=P3*P8
      P(060)=P3*P8*P8
      P(061)=P3*P7
      P(062)=P3*P7*P8
      P(063)=P3*P7*P7
      P(064)=P3*P6
      P(065)=P3*P6*P8
      P(066)=P3*P6*P7
      P(067)=P3*P6*P6
      P(068)=P3*P5
      P(069)=P3*P5*P8
      P(070)=P3*P5*P7
      P(071)=P3*P5*P6
      P(072)=P3*P5*P5
      P(073)=P3*P4
      P(074)=P3*P4*P8
      P(075)=P3*P4*P7
      P(076)=P3*P4*P6
      P(077)=P3*P4*P5
      P(078)=P3*P4*P4
      P(079)=P3*P3
      P(080)=P3*P3*P8
      P(081)=P3*P3*P7
      P(082)=P3*P3*P6
      P(083)=P3*P3*P5
      P(084)=P3*P3*P4
      P(085)=P3*P3*P3
      P(086)=P2
      P(087)=P2*P8
      P(088)=P2*P8*P8
      P(089)=P2*P7
      P(090)=P2*P7*P8
      P(091)=P2*P7*P7
      P(092)=P2*P6
      P(093)=P2*P6*P8
      P(094)=P2*P6*P7
      P(095)=P2*P6*P6
      P(096)=P2*P5
      P(097)=P2*P5*P8
      P(098)=P2*P5*P7
      P(099)=P2*P5*P6
      P(100)=P2*P5*P5
      P(101)=P2*P4
      P(102)=P2*P4*P8
      P(103)=P2*P4*P7
      P(104)=P2*P4*P6
      P(105)=P2*P4*P5
      P(106)=P2*P4*P4
      P(107)=P2*P3
      P(108)=P2*P3*P8
      P(109)=P2*P3*P7
      P(110)=P2*P3*P6
      P(111)=P2*P3*P5
      P(112)=P2*P3*P4
      P(113)=P2*P3*P3
      P(114)=P2*P2
      P(115)=P2*P2*P8
      P(116)=P2*P2*P7
      P(117)=P2*P2*P6
      P(118)=P2*P2*P5
      P(119)=P2*P2*P4
      P(120)=P2*P2*P3
      P(121)=P2*P2*P2
      P(122)=P1
      P(123)=P1*P8
      P(124)=P1*P8*P8
      P(125)=P1*P7
      P(126)=P1*P7*P8
      P(127)=P1*P7*P7
      P(128)=P1*P6
      P(129)=P1*P6*P8
      P(130)=P1*P6*P7
      P(131)=P1*P6*P6
      P(132)=P1*P5
      P(133)=P1*P5*P8
      P(134)=P1*P5*P7
      P(135)=P1*P5*P6
      P(136)=P1*P5*P5
      P(137)=P1*P4
      P(138)=P1*P4*P8
      P(139)=P1*P4*P7
      P(140)=P1*P4*P6
      P(141)=P1*P4*P5
      P(142)=P1*P4*P4
      P(143)=P1*P3
      P(144)=P1*P3*P8
      P(145)=P1*P3*P7
      P(146)=P1*P3*P6
      P(147)=P1*P3*P5
      P(148)=P1*P3*P4
      P(149)=P1*P3*P3
      P(150)=P1*P2
      P(151)=P1*P2*P8
      P(152)=P1*P2*P7
      P(153)=P1*P2*P6
      P(154)=P1*P2*P5
      P(155)=P1*P2*P4
      P(156)=P1*P2*P3
      P(157)=P1*P2*P2
      P(158)=P1*P1
      P(159)=P1*P1*P8
      P(160)=P1*P1*P7
      P(161)=P1*P1*P6
      P(162)=P1*P1*P5
      P(163)=P1*P1*P4
      P(164)=P1*P1*P3
      P(165)=P1*P1*P2
      P(166)=P1*P1*P1
      RETURN
      END
C***********************************************************************
      SUBROUTINE YX2LL(ALAT0,ALON0,DISP,CFCST)
C INCOMING ARGUMENTS:
C     ALAT0, ALON0...INITIAL STORM POSTION
C     DISP...........FORECAST MERIDIONAL & ZONAL DISPLACEMENTS IN NMI.
C RETURNED ARGUMENT:
C     CDISP..........FORECASTS IN TERMS OF LAT/LON
C
      REAL*4 DISP(12),CFCST(12)
      CALL STHGPR(ALAT0,F1(ALON0),360.,1.,0.,0.)
      DO 10 I=1,6
      CALL XY2LLH(DISP(2*I),DISP(2*I-1),CFCST(2*I-1),CFCST(2*I))
C NOTE: ABOVE SUBROUTINE RETURNS LONGITUDES WEST OF 180 AS NEGATIVE AND
C EAST OF 180 AS POSITIVE.  CONVERT ALL LONGITUDES TO EAST
      IF(CFCST(2*I).GE.0.AND.CFCST(2*I).LT.180.)CFCST(2*I)=360.-
     $CFCST(2*I)
      IF(CFCST(2*I).LT.0.)CFCST(2*I)=-CFCST(2*I)
   10 CONTINUE
      RETURN
      END
cx*********************************************************************
cx    FUNCTION NEWCYC(NOWCYC,N)
cxGIVEN CYCLE TIME NOWCYC, GET NEW CYCLE TIME (NEWCYC) GIVEN BY
cxNOWCYC + N HOURS.  LIMIT 0F N IS + OR - 744 HOURS.  ALLOWANCES
cxARE MADE FOR LEAP YEARS.
cx(C.J.NEUMANN, SAIC, OCTOBER, 1989)
cx    CHARACTER*8 ALFA
cx    INTEGER NHEM(15),NOLEAP(15),ADDYR
cx    DATA NOLEAP /000,744,1488,2160,2904,3624,4368,5088,5832,6576,7296,
cx   $8040,8760,9504,10248/
cxABOVE DATA STATEMENT GIVES NUMBER OF HOURS FOR NON-LEAP YEAR MONTHS
cxMONTHS 0000UTC ON 1 DEC THRU 0000UTC ON 1 FEB OF SECOND YEAR.
cx
cxOBTAIN YEAR (KYR),MONTH (M0),DAY (KDA) AND HOUR (JTM) IN INTEGER FORMAT
cx    WRITE(ALFA,'(I8)')NOWCYC
cx    READ(ALFA,'(4I2)')KYR,MO,KDA,JTM
cx    DO 10 I=1,15
cx 10 NHEM(I)=NOLEAP(I)
cxIS THIS A LEAP YEAR? (YEAR 2000 IS A LEAP YEAR)
cx    IF(MOD(KYR,4).EQ.0)THEN
cx    DO 20 I=4,15
cx 20 NHEM(I)=NHEM(I)+24
cx    ENDIF
cxHOW MANY HRS FROM BEGINNING OF TIME WINDOW AT 0000UTC, 1 DEC (NHROLD)?
cx    NHROLD=NHEM(MO+1)+(KDA-1)*24+JTM
cxHOW MANY HRS NEEDED FROM BEGINNING OF WINDOW (NHRNEW)?
cx    NHRNEW=NHROLD+N
cx
cx    DO 30 MO=2,15
cxMO = 2 = PREVIOUS YEAR; M0 = 15 = NEXT YEAR; DO WE NEED TO ADD OR
cxSUBTRACT A YEAR??
cx    KYRNEW=KYR-(2/MO)+MO/15
cxCHANGE OF CENTURY?
cx    IF(KYRNEW.EQ.100)KYRNEW=0
cx    IF(KYRNEW.EQ.-1)KYRNEW=99
cx
cx    IF(NHRNEW.LT.NHEM(MO))GOTO 40
cx 30 CONTINUE
cx 40 NDIF=NHRNEW-NHEM(MO-1)
cx    LDA=(NDIF+24)/24
cx    LTM=NDIF+24-(LDA*24)
cx    INDEX=MOD(MO-3,12)+(2/MO)*12+1
cx    NEWCYC=KYRNEW*1000000+INDEX*10000+LDA*100+LTM
cx    RETURN
cx    END
cx*******************************************************************8
cx    SUBROUTINE LL2DB(XLATO,XLONO,XLATT,XLONT,DIST,BEAR)
cx     ALBION D. TAYLOR MARCH 18, 1981
cx    DATA RRTHNM/3 440.17/,RADPDG/1.745 3293 E-2/
cx  RRTHNM=RADIUS OF EARTH IN NAUT. MILES, RADPDG==OF RADIANS
cx  PER DEGREE
cx---------------------------------------------------------------------*
cx GIVEN AN ORIGIN AT LATITUDE, LONGITUDE=XLATO,XLONO, WILL LOCATE     *
cx A TARGET POINT AT LATITUDE, LONGITUDE = XLATT, XLONT.  RETURNS      *
cx DISTANCE DIST IN NAUTICAL MILES, AND BEARING BEAR (DEGREES CLOCKWISE*
cx FROM NORTH).                                                        *
cx                                                                     *
cx ALL LATITUDES ARE IN DEGREES, NORTH POSITIVE AND SOUTH NEGATIVE.    *
cx ALL LONGITUDES ARE IN DEGREES, WEST POSITIVE AND EAST NEGATIVE.     *
cx                                                                     *
cx NOTE-- WHEN ORIGIN IS AT NORTH OR SOUTH POLE, BEARING IS NO LONGER  *
cx MEASURED FROM NORTH.  INSTEAD, BEARING IS MEASURED CLOCKWISE        *
cx FROM THE LONGITUDE OPPOSITE THAT SPECIFIED IN XLONO.                *
cx EXAMPLE-- IF XLATO=90., XLONO=80., THE OPPOSITE LONGITUDE IS -100.  *
cx (100 EAST), AND A TARGET AT BEARING 30. WILL LIE ON THE -70.        *
cx (70 EAST) MERIDIAN                                                  *
cx---------------------------------------------------------------------*
cx    CLATO=COS(RADPDG*XLATO)
cx    SLATO=SIN(RADPDG*XLATO)
cx    CLATT=COS(RADPDG*XLATT)
cx    SLATT=SIN(RADPDG*XLATT)
cx    CDLON=COS(RADPDG*(XLONT-XLONO))
cx    SDLON=SIN(RADPDG*(XLONT-XLONO))
cx    Z=SLATT*SLATO + CLATT*CLATO*CDLON
cx    Y= - CLATT*SDLON
cx    X=CLATO*SLATT - SLATO*CLATT*CDLON
cx    R=SQRT(X*X+Y*Y)
cx    DIST=RRTHNM*ATAN2(R,Z)
cx    IF (R.LE.0.) GO TO 20
cx    BEAR=ATAN2(-Y,-X)/RADPDG + 180.
cx    RETURN
cx 20 BEAR=0.
cx    RETURN
cx    END
C***********************************************************************
      BLOCK DATA BLKSW1
C
C ENTER ALL CONSTANTS NEEDED BY SWPCPR PROGRAM......
C
      INTEGER*2
     $       N12M(31),N24M(31),N36M(31),N48M(31),N60M(31),N72M(31)
      INTEGER*2
     $       N12Z(31),N24Z(31),N36Z(31),N48Z(31),N60Z(31),N72Z(31)
      REAL*4 R12M(31),R24M(31),R36M(31),R48M(31),R60M(31),R72M(31)
      REAL*4 R12Z(31),R24Z(31),R36Z(31),R48Z(31),R60Z(31),R72Z(31)
      COMMON/BLOCKSW1/RCM(31,6),RCZ(31,6),CNSTM(6),CNSTZ(6)
      INTEGER*2 NPM(31,6),NPZ(31,6)
      COMMON/BLOCKSW2/NPM,NPZ
C
      EQUIVALENCE
     $(N12M(1),NPM(1,1)),(N24M(1),NPM(1,2)),(N36M(1),NPM(1,3))
      EQUIVALENCE
     $(N48M(1),NPM(1,4)),(N60M(1),NPM(1,5)),(N72M(1),NPM(1,6))
      EQUIVALENCE
     $(N12Z(1),NPZ(1,1)),(N24Z(1),NPZ(1,2)),(N36Z(1),NPZ(1,3))
      EQUIVALENCE
     $(N48Z(1),NPZ(1,4)),(N60Z(1),NPZ(1,5)),(N72Z(1),NPZ(1,6))
C
      EQUIVALENCE
     $(R12M(1),RCM(1,1)),(R24M(1),RCM(1,2)),(R36M(1),RCM(1,3))
      EQUIVALENCE
     $(R48M(1),RCM(1,4)),(R60M(1),RCM(1,5)),(R72M(1),RCM(1,6))
      EQUIVALENCE
     $(R12Z(1),RCZ(1,1)),(R24Z(1),RCZ(1,2)),(R36Z(1),RCZ(1,3))
      EQUIVALENCE
     $(R48Z(1),RCZ(1,4)),(R60Z(1),RCZ(1,5)),(R72Z(1),RCZ(1,6))
C
C  12HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R12M/
     A-.4287692E+1, .2818728E+0, .1531582E+1,-.1054133E+0,-.2186656E-6,
     B-.4755538E-5, .8606674E-4, .3035332E-5, .1681255E+1,-.4292762E-2,
     C .5451203E-1,-.1388062E-3,-.1671499E-1, .9399905E-5,-.3655966E-4,
     D-.2632264E-4,-.7627359E-5, .4124779E-4, .3702111E-5,-.2835288E-5,
     E .1992647E-5, .4542270E-5,-.6337432E-6, .4555284E-5, .3172314E-5,
     F .3638802E-5,-.1500442E-5,-.5920183E-6, .7568453E-3, .1066462E-5,
     G .4031802E-6/
C
C  12HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N12M/
     A         037,         022,         012,         006,         091,
     B         035,         138,         049,         086,         114,
     C         101,         119,         092,         024,         126,
     D         149,         097,         117,         098,         100,
     E         130,         053,         031,         135,         008,
     F         146,         044,         115,         023,         108,
     G         050/
C
C  24HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R24M/
     A .7219834E-1,-.1812531E-2, .7759157E-4,-.9043463E-4, .1739864E-4,
     B .1723866E-3, .7950909E+1,-.2112079E-1,-.5877865E-5, .1316165E-4,
     C .3130879E-5,-.4076088E-5,-.1727260E+0, .5040320E+0, .5304649E-4,
     D-.1710418E-5,-.5500862E-4, .1253498E-6,-.1005590E-4, .1066905E-4,
     E .3660225E-5,-.1280670E-4, .2636333E+1,-.6546882E-5, .2211754E-4,
     F-.6047287E-4,-.1062746E-5, .7228092E-5,-.1749418E-3,-.5311209E+1,
     G-.3094506E-1/
C
C  24HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N24M/
     A         101,         023,         117,         126,         098,
     B         138,         086,         114,         035,         044,
     C         049,         091,         006,         022,         024,
     D         108,         135,         031,         100,         130,
     E         050,         053,         012,         008,         146,
     F         149,         115,         097,         119,         037,
     G         092/
C
C  36HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R36M/
     A .2131797E+0, .3706641E-4,-.1148131E-3,-.7029843E-1, .2650750E-4,
     B-.2310212E-4,-.1134127E-4, .1301733E+2,-.3398344E-1,-.1323961E-3,
     C .1777998E-3,-.4517950E-4, .7406342E+0, .1785662E-3, .2774475E-5,
     D-.2095038E-3, .1041766E-4, .5252792E-4,-.2006225E+0, .1877635E-3,
     E .6052240E+1,-.1077771E-1,-.1248108E-4, .4368852E-4, .2081658E-5,
     F .6929379E-4,-.5172233E-5,-.5611676E-3,-.1740277E+2,-.1233750E-4,
     G .3141744E-6/
C
C  36HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N36M/
     A         101,         097,         126,         092,         044,
     B         100,         035,         086,         114,         146,
     C         024,         008,         022,         138,         049,
     D         135,         050,         130,         006,         117,
     E         012,         023,         091,         098,         031,
     F         149,         108,         119,         037,         053,
     G         115/
C
C  48HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R48M/
     A-.1940412E-3, .3338362E-3, .1097468E-3,-.1320773E-3,-.7788396E-4,
     B-.4567575E-3,-.7994210E-4, .1468041E-4,-.4807591E-3, .4225687E-3,
     C-.2674650E-4, .9120648E-1,-.7511978E+1, .1880544E+2,-.4807551E-1,
     D .2930958E-3, .1312998E-4,-.3291533E-4, .1135152E-3, .1010927E-3,
     E .1262370E+1,-.1412983E-3,-.3165654E+0,-.2127615E-1, .4765577E-4,
     F .3932788E-1,-.2653732E-4, .9419601E-5,-.1224863E-4,-.2948578E+1,
     G .1947467E-5/
C
C  48HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N48M/
     A         119,         024,         053,         117,         008,
     B         135,         100,         031,         146,         149,
     C         035,         101,         037,         086,         114,
     D         138,         049,         091,         098,         130,
     E         022,         126,         006,         023,         097,
     F         092,         044,         050,         108,         012,
     G         115/
C
C  60HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R60M/
     A .1298005E-3, .4760712E-3,-.1217524E-3,-.8984325E-3,-.5744392E-3,
     B .1767888E-4,-.2822072E-4, .1014145E-3, .3170690E+2,-.8314960E-1,
     C-.4256153E-1,-.1177597E-3,-.3051235E-4, .8623369E-3, .1486915E-4,
     D .2637512E-4,-.4279953E-4, .1489218E-3, .1845038E-4,-.2632877E-3,
     E .1094307E+1, .8520777E-4,-.2106894E+0, .6038574E+1,-.1174886E-1,
     F-.2752771E-3,-.9248588E+1, .1021008E+0, .7847991E-4,-.6819550E-5,
     G-.2707957E-5/
C
C  60HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N60M/
     A         119,         024,         008,         146,         135,
     B         050,         108,         053,         086,         114,
     C         101,         100,         035,         149,         115,
     D         049,         091,         098,         031,         126,
     E         022,         130,         006,         037,         023,
     F         117,         012,         092,         138,         044,
     G         097/
C
C  72HR MERIDIONAL REGRESSION COEFFICIENTS
      DATA R72M/
     A .4869786E-3, .3139089E-4, .6226165E-3,-.1284850E-4, .1587036E-4,
     B-.1146980E-2,-.1792561E-3, .1090566E-2, .2936242E-4, .5015800E+2,
     C-.1335983E+0,-.1820270E+0,-.4730774E-3, .4767377E-4,-.3725974E-4,
     D-.1635298E-3, .2128050E-4,-.4045876E-4, .1044304E+1,-.1153728E-3,
     E-.2409394E+0,-.1702508E-3,-.1031337E-3,-.3930025E-4, .1297369E-3,
     F .6035300E-4,-.3732730E-3,-.1336571E+2, .1430393E+0, .1969062E+2,
     G .3655747E-2/
C
C  72HR MERIDIONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N72M/
     A         119,         115,         024,         130,         050,
     B         146,         008,         149,         044,         086,
     C         114,         101,         135,         049,         035,
     D         126,         031,         108,         022,         097,
     E         006,         138,         100,         091,         098,
     F         053,         117,         012,         092,         037,
     G         023/
C
C    12 THROUGH 72HR MERIDIONAL INTERCEPT VALUES
      DATA CNSTM/
     $-.14864E+3,-.69449E+3,-.11465E+4,-.16752E+4,-.28095E+4,-.44417E+4/
C
C  12HR ZONAL REGRESSION COEFFICIENTS
      DATA R12Z/
     A .8272212E+0,-.2821487E-1, .2188856E-4, .4904044E-4,-.1186432E-4,
     B .1891602E-4,-.1009734E-4, .4801687E-5, .3034516E-5,-.5680390E-1,
     C-.3707809E-6, .6521890E-5,-.9741484E-5, .1659947E-5,-.2275189E-5,
     D-.1905439E-4, .2371689E-2, .5194635E-4,-.2329734E-4,-.8382909E-3,
     E-.9148710E-2, .1659897E-4, .1048122E-3,-.1188157E-5, .6002806E-4,
     F-.8836303E-6,-.7455742E-5, .1938524E-6, .2163060E-6,-.6700967E-5,
     G-.7487800E-5/
C
C  12HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N12Z/
     A         022,         006,         076,         157,         054,
     B         056,         036,         034,         095,         012,
     C         021,         060,         067,         072,         121,
     D         142,         096,         069,         062,         089,
     E         150,         151,         165,         131,         009,
     F         010,         147,         019,         055,         144,
     G         163/
C
C  24HR ZONAL REGRESSION COEFFICIENTS
      DATA R24Z/
     A .2063707E+1,-.3357145E+0, .6836551E-5,-.3129525E-4, .1856783E-4,
     B-.1074454E-4,-.2365235E-4,-.1482711E+0,-.2725321E-4, .4400867E-4,
     C .1380769E-4,-.1281273E-3, .5862035E-4, .2064152E-3, .1986785E-2,
     D .4822288E-5, .9806713E-4,-.5071852E-4, .2002428E-5,-.8195533E-5,
     E-.2190036E-1, .1748470E-3,-.8485891E-4,-.9325183E-5, .1603337E-4,
     F-.2997504E-4,-.5949957E-4,-.7062224E-5,-.1847495E-3, .4589968E-7,
     G .3837156E-5/
C
C  24HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N24Z/
     A         022,         006,         095,         036,         072,
     B         055,         151,         012,         054,         056,
     C         034,         009,         144,         157,         096,
     D         019,         076,         067,         021,         121,
     E         150,         069,         062,         131,         060,
     F         147,         165,         142,         089,         010,
     G         163/
C
C  36HR ZONAL REGRESSION COEFFICIENTS
      DATA R36Z/
     A .2340691E-1,-.1054184E-1, .1140256E-4,-.5274031E-4, .1013532E-3,
     B .2381868E-3,-.3183674E-3,-.2538885E+0, .1124281E+1,-.3209144E-4,
     C .4905052E-4, .2290086E-4, .1203770E-4, .4073604E-5,-.9930932E-4,
     D .1722713E-3,-.2246730E-4,-.6333156E-3, .3771087E-4,-.5791333E-2,
     E-.1334337E-3, .2565115E-3,-.2889898E-4, .7081124E-4,-.8817424E-4,
     F .4131816E-4,-.8401021E-5, .2172888E-3, .1402107E-5,-.4444249E+0,
     G-.2584016E-5/
C
C  36HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N36Z/
     A         096,         089,         019,         036,         147,
     B         144,         165,         012,         006,         054,
     C         056,         034,         095,         021,         067,
     D         076,         055,         009,         072,         150,
     E         062,         069,         131,         142,         151,
     F         060,         121,         157,         010,         022,
     G         163/
C
C  48HR ZONAL REGRESSION COEFFICIENTS
      DATA R48Z/
     A .3610687E-1,-.1597900E-1, .4438812E-3,-.6364309E-4, .6768669E-5,
     B .3598207E-5,-.1276235E-2, .1692604E-3,-.1460915E-3, .1745373E-4,
     C .2265086E-3,-.2481118E+0,-.2989547E-4, .1720388E+1, .6090402E-4,
     D .2222404E-3, .2627062E-4,-.2712250E-4, .9088231E-4, .3761448E-4,
     E-.1995767E-3, .3809168E-3, .1210026E-3,-.1633291E+1,-.2673949E-3,
     F .6886311E-5,-.1157471E-3,-.7659700E-5,-.1022189E-2, .3323501E-5,
     G .2123853E-1/
C
C  48HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N48Z/
     A         096,         089,         144,         036,         131,
     B         021,         009,         147,         067,         095,
     C         076,         012,         055,         006,         072,
     D         157,         034,         054,         060,         056,
     E         062,         069,         142,         022,         163,
     F         019,         151,         121,         165,         010,
     G         150/
C
C  60HR ZONAL REGRESSION COEFFICIENTS
      DATA R60Z/
     A .3987733E-1,-.1704373E-1, .6661806E-3,-.1728967E-2,-.2469190E-4,
     B-.1376384E-3,-.2298098E-3, .9537430E-5, .9021796E-4, .6723615E-5,
     C-.9040680E-4, .4407617E-4, .1661725E-3, .2571493E-4, .1737037E+1,
     D .5629304E-3,-.2817416E-3, .1294186E+0, .1610824E-3,-.1702458E-3,
     E-.2705557E+0,-.4644499E-4, .2272446E-3,-.1372048E-2,-.2055748E+1,
     F-.2734174E-3, .5830324E-4,-.2907653E-4, .6683014E-4, .1259299E-5,
     G-.5199808E-6/
C
C  60HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N60Z/
     A         096,         089,         144,         009,         131,
     B         067,         163,         121,         072,         021,
     C         036,         034,         076,         095,         006,
     D         069,         062,         150,         060,         151,
     E         012,         055,         142,         165,         022,
     F         157,         056,         054,         147,         019,
     G         010/
C
C  72HR ZONAL REGRESSION COEFFICIENTS
      DATA R72Z/
     A-.2664871E+1, .2910618E-3, .1909511E+1,-.9914097E-5, .2680403E+0,
     B .7465051E-3,-.3595912E-3, .4981306E-3,-.6412225E-4,-.7438001E-5,
     C .3070849E-4, .9225095E-4,-.4781626E+0, .3906929E-4,-.1123542E-2,
     D-.1598617E-2,-.2515303E-3, .4130599E-1,-.1780620E-1,-.6823870E-4,
     E .3523589E-4, .5590919E-4,-.6953179E-3, .1265137E-4,-.5831036E-4,
     F-.2138516E-4,-.1483777E-3, .6939810E-3, .5264840E-3, .8924841E-6,
     G-.7022630E-5/
C
C  72HR ZONAL PREDICTOR NUMBERS ASSOCIATED WITH ABOVE COEFFICIENTS
      DATA N72Z/
     A         022,         060,         006,         010,         150,
     B         069,         062,         142,         055,         076,
     C         095,         072,         012,         121,         157,
     D         009,         151,         096,         089,         036,
     E         034,         056,         165,         021,         067,
     F         054,         131,         163,         144,         019,
     G         147/
C
C    12 THROUGH 72HR ZONAL INTERCEPT VALUES
      DATA CNSTZ/
     $ .10063E+2, .24147E+2, .14084E+2,-.12586E+2,-.11908E+3,-.24339E+3/
      END
C***********************************************************************
      SUBROUTINE UPRCAS(EORW00,EORW12,EORW24)
      CHARACTER*1 EORW00,EORW12,EORW24
C ASSURE THAT 'E' OR 'W' IS IN UPPER CASE
      IF(EORW00.EQ.'e')EORW00='E'
      IF(EORW12.EQ.'e')EORW12='E'
      IF(EORW24.EQ.'e')EORW24='E'
      IF(EORW00.EQ.'w')EORW00='W'
      IF(EORW12.EQ.'w')EORW12='W'
      IF(EORW24.EQ.'w')EORW24='W'
      RETURN
      END
